{"version":3,"sources":["webpack:///clerk.min.js","webpack:///webpack/bootstrap 4803bd8433c155e21d67","webpack:///./clerk.js","webpack:///./~/superagent/lib/client.js","webpack:///./~/superagent/~/component-emitter/index.js","webpack:///./~/superagent/~/reduce-component/index.js"],"names":["this","modules","__webpack_require__","moduleId","installedModules","exports","module","id","loaded","call","m","c","p","request","extend","target","source","key","i","arguments","asString","that","Object","prototype","toString","isString","isArray","isFunction","clerk","uri","make","version","defaultHost","Promise","Client","_parseURI","db","exec","path","substr","index","decodeURIComponent","auth","btoa","client","base","Buffer","str","match","replace","Base","args","slice","callback","length","pop","_request","method","query","data","headers","fn","options","body","JSON","stringify","test","_replacer","promise","defer","err","status","res","reject","defineProperties","_status","value","_headers","_response","resolve","g","_","apply","req","_do","self","set","withCredentials","send","end","error","text","_error","header","json","len","item","rows","results","uuids","meta","_meta","doc","Error","reason","code","val","proto","hasId","_id","hasRev","_rev","rev","start","withDoc","q","b","h","f","encodeURI","shift","_db","name","DB","dbs","count","info","stats","log","tasks","config","replicate","encodeURIComponent","create","destroy","exists","get","head","etag","parse","contentType","contentLength","post","docs","put","del","_deleted","copy","sourcePath","targetPath","sourceRev","targetRev","Destination","all","_viewOptions","find","view","split","changes","feed","_changes","follow","done","update","handler","attachment","attachmentName","attach","commit","purge","revs","compact","vacuum","startkey","endkey","stale","keys","noop","isHost","obj","getXHR","root","XMLHttpRequest","location","protocol","ActiveXObject","e","isObject","serialize","pairs","push","join","parseString","parts","pair","parseHeader","line","field","lines","fields","indexOf","toLowerCase","trim","type","params","reduce","Response","xhr","responseText","setStatusProperties","getAllResponseHeaders","getResponseHeader","setHeaderProperties","parseBody","Request","url","Emitter","_query","_header","on","original","window","s","serializeObject","types","html","xml","urlencoded","form","form-data","application/x-www-form-urlencoded","application/json","ct","statusType","ok","clientError","serverError","toError","accepted","noContent","badRequest","unauthorized","notAcceptable","notFound","forbidden","msg","use","timeout","ms","_timeout","clearTimeout","_timer","abort","aborted","emit","unset","getHeader","accept","user","pass","_formData","FormData","append","file","filename","_data","_callback","crossDomainError","crossDomain","timeoutError","_withCredentials","onreadystatechange","readyState","upload","onprogress","percent","total","setTimeout","open","setRequestHeader","patch","mixin","addEventListener","event","_callbacks","once","off","removeListener","removeAllListeners","removeEventListener","callbacks","cb","splice","listeners","hasListeners","arr","initial","idx","curr"],"mappings":"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","file":"clerk.min.js","sourcesContent":["this[\"clerk\"] =\n/******/ (function(modules) { // webpackBootstrap\n/******/ \t// The module cache\n/******/ \tvar installedModules = {};\n/******/\n/******/ \t// The require function\n/******/ \tfunction __webpack_require__(moduleId) {\n/******/\n/******/ \t\t// Check if module is in cache\n/******/ \t\tif(installedModules[moduleId])\n/******/ \t\t\treturn installedModules[moduleId].exports;\n/******/\n/******/ \t\t// Create a new module (and put it into the cache)\n/******/ \t\tvar module = installedModules[moduleId] = {\n/******/ \t\t\texports: {},\n/******/ \t\t\tid: moduleId,\n/******/ \t\t\tloaded: false\n/******/ \t\t};\n/******/\n/******/ \t\t// Execute the module function\n/******/ \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n/******/\n/******/ \t\t// Flag the module as loaded\n/******/ \t\tmodule.loaded = true;\n/******/\n/******/ \t\t// Return the exports of the module\n/******/ \t\treturn module.exports;\n/******/ \t}\n/******/\n/******/\n/******/ \t// expose the modules object (__webpack_modules__)\n/******/ \t__webpack_require__.m = modules;\n/******/\n/******/ \t// expose the module cache\n/******/ \t__webpack_require__.c = installedModules;\n/******/\n/******/ \t// __webpack_public_path__\n/******/ \t__webpack_require__.p = \"\";\n/******/\n/******/ \t// Load entry module and return exports\n/******/ \treturn __webpack_require__(0);\n/******/ })\n/************************************************************************/\n/******/ ([\n/* 0 */\n/***/ function(module, exports, __webpack_require__) {\n\n\"use strict\";\n\n/*!\n\nclerk - CouchDB client for node and the browser.\nCopyright 2012-2015 Michael Phan-Ba\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\n/**\n * Module dependencies.\n */\n\nvar request = __webpack_require__(1);\n\n/**\n * Copy properties from sources to target.\n *\n * @param {Object} target The target object.\n * @param {Object...} sources The source object.\n * @return {Object} The target object.\n * @api private\n */\n\nvar extend = function (target /* sources.. */) {\n  var source, key, i = 1;\n  while (source = arguments[i++]) {\n    for (key in source) target[key] = source[key];\n  }\n  return target;\n};\n\n/**\n * Stringify value.\n *\n * @param {Object} that That value to stringify.\n * @return {String} The stringifyed value.\n * @api private\n */\n\nvar asString = function (that) {\n  return Object.prototype.toString.call(that);\n};\n\n/**\n * Check if value is a string.\n *\n * @param {Object} that That value to check.\n * @return {Boolean} `true` if string, `false` otherwise.\n * @api private\n */\n\nvar isString = function (that) {\n  return asString(that) == \"[object String]\";\n};\n\n/**\n * Check if value is an object.\n *\n * @param {Object} that That value to check.\n * @return {Boolean} `true` if object, `false` otherwise.\n * @api private\n */\n\nvar isObject = function (that) {\n  return asString(that) == \"[object Object]\";\n};\n\n/**\n * Check if value is an array.\n *\n * @param {Object} that That value to check.\n * @return {Boolean} `true` if array, `false` otherwise.\n * @api private\n */\n\nvar isArray = function (that) {\n  return asString(that) == \"[object Array]\";\n};\n\n/**\n * Check if value is a function.\n *\n * @param {Object} that That value to check.\n * @return {Boolean} `true` if function, `false` otherwise.\n * @api private\n */\n\nvar isFunction = function (that) {\n  return asString(that) == \"[object Function]\";\n};\n\n/**\n * Clerk library entry point.\n *\n * @param {String} servers CouchDB server URI.\n * @return {Client|DB} If a URI path is given, returns a `DB`, otherwise\n *   returns a `Client`.\n * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/)\n * @see [CouchDB Guide](http://guide.couchdb.org/)\n * @see [Couchbase 2.0](http://www.couchbase.com/docs/couchbase-single-server-2.0/)\n */\n\nvar clerk = function (uri) {\n  return clerk.make(uri);\n};\n\n/**\n * Library version.\n */\n\nclerk.version = \"0.7.1\";\n\n/**\n * Default host.\n */\n\nclerk.defaultHost = \"http://127.0.0.1:5984\";\n\n/**\n * Promise implementation.\n */\n\nclerk.Promise = typeof Promise != \"undefined\" && Promise;\n\n/**\n * Create single CouchDB client.\n *\n * @param {String} uri Fully qualified URI.\n * @return {Client|DB} If `uri` has a path, the last segment of the\n *    path is used as the database name and a `DB` instance is\n *    returned. Otherwise, a `Client` instance is returned.\n */\n\nclerk.make = function (uri) {\n  if (!uri) return new clerk.Client(this.defaultHost);\n\n  uri = clerk._parseURI(uri);\n\n  var db = /\\/*([^\\/]+)\\/*$/.exec(uri.path);\n  if (db) {\n    uri.path = uri.path.substr(0, db.index);\n    db = db[1] && decodeURIComponent(db[1]);\n  }\n\n  // weird way of doing it, but it's more efficient...\n  if (uri.auth) uri.auth = 'Basic ' + clerk.btoa(uri.auth);\n\n  var client = new clerk.Client(uri.base + uri.path, uri.auth);\n  return db ? client.db(db) : client;\n};\n\n/**\n * Base64-encode a string.\n *\n * @param {String} str\n * @return {String}\n */\n\nclerk.btoa = typeof Buffer != \"undefined\" ? function (str) {\n  return new Buffer(str).toString(\"base64\");\n} : function (str) {\n  return btoa(str);\n};\n\n/**\n * Parse URI.\n *\n * The URI is normalized by removing extra `//` in the path.\n *\n * @param {String} uri Fully qualified URI.\n * @return {String} The normalized URI.\n */\n\nclerk._parseURI = function (uri) {\n  var match;\n\n  if (uri) {\n    if (match = /^(https?:\\/\\/)(?:([^\\/@]+)@)?([^\\/]+)(.*)\\/*$/.exec(uri)) {\n      return {\n        base: match[1] + match[3].replace(/\\/+/g, \"\\/\"),\n        path: match[4],\n        auth: match[2] && decodeURIComponent(match[2])\n      };\n    }\n  }\n\n  return { base: uri || \"\", path: \"\" };\n};\n\n/**\n * Base prototype for `Client` and `DB`.\n * Encapsulates HTTP methods, JSON handling, and response coersion.\n */\n\nclerk.Base = function () {};\n\nclerk.Base.prototype = {\n\n  /**\n   * Service request and parse JSON response.\n   *\n   * @param {String} [method=\"\"GET\"\"] HTTP method.\n   * @param {String} [path=this.uri] HTTP URI.\n   * @param {Object} [query] HTTP query options.\n   * @param {Object} [body] HTTP body.\n   * @param {Object} [headers] HTTP headers.\n   * @param {Function} [callback] Callback function.\n   *   @param {Error|null} error Error or `null` on success.\n   *   @param {Object} data Response data.\n   *   @param {Integer} status Response status code.\n   *   @param {Object} headers Response headers.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  request: function (/* [method], [path], [query], [data], [headers], [callback] */) {\n    var args = [].slice.call(arguments);\n    var callback = isFunction (args[args.length - 1]) && args.pop();\n\n    return this._request({\n      method: args[0],\n      path: args[1],\n      query: args[2],\n      data: args[3],\n      headers: args[4],\n      fn: callback\n    });\n  },\n\n  /**\n   * Internal service request and parse JSON response handler.\n   *\n   * @param {String} options\n   *   @param {String} method HTTP method.\n   *   @param {String} path HTTP URI.\n   *   @param {Object} query HTTP query options.\n   *   @param {Object} data HTTP body data.\n   *   @param {Object} headers HTTP headers.\n   *   @param {Function} fn Callback function.\n   *     @param {Error|null} error Error or `null` on success.\n   *     @param {Object} data Response data.\n   *     @param {Integer} status Response status code.\n   *     @param {Object} headers Response headers.\n   * @api private\n   */\n\n  _request: function (options) {\n    if (options.method == null) options.method = \"GET\";\n    if (options.headers == null) options.headers = {};\n    if (options.auth == null) options.auth = this.auth;\n\n    options.path = options.path ? \"/\" + options.path : \"\";\n\n    // set default headers\n    if (options.headers[\"Content-Type\"] == null) {\n      options.headers[\"Content-Type\"] = \"application/json\";\n    }\n    if (options.headers[\"Accept\"] == null) {\n      options.headers[\"Accept\"] = \"application/json\";\n    }\n    if (this.auth && options.headers[\"Authorization\"] == null) {\n      options.headers[\"Authorization\"] = this.auth;\n    }\n\n    options.uri = this.uri + options.path;\n    options.body = options.data && JSON.stringify(options.data,\n      /^\\/_design/.test(options.path) && this._replacer\n    ) || \"\";\n\n    // create promise if no callback given\n    var promise;\n    var fn = options.fn;\n    if (!fn && clerk.Promise) {\n      promise = clerk.Promise.defer();\n      fn = function (err, data, status, headers, res) {\n        if (err) {\n          err.body = data;\n          err.status = status;\n          err.headers = headers;\n          err.res = res;\n          promise.reject(err);\n        } else {\n          if (Object.defineProperties) {\n            Object.defineProperties(data, {\n              _status: { value: status },\n              _headers: { value: headers },\n              _response: { value: res },\n            });\n          }\n          promise.resolve(data);\n        };\n      };\n    }\n\n    // apply response transforms\n    var g = options._;\n    if (fn) {\n      options.fn = g ? function () {\n        fn.apply(this, g.apply(this, arguments) || arguments);\n      } : fn;\n    }\n\n    var req = this._do(options);\n\n    // return promise if it was created\n    if (promise) {\n      promise.promise.request = req;\n      return promise.promise;\n    }\n  },\n\n  /**\n   * Provider for servicing requests and parsing JSON responses.\n   *\n   * @param {String} options\n   *   @param {String} method HTTP method.\n   *   @param {String} uri HTTP URI.\n   *   @param {Object} query HTTP query options.\n   *   @param {Object} body HTTP body.\n   *   @param {Object} headers HTTP headers.\n   *   @param {Object} auth HTTP authentication.\n   *   @param {Function} fn Callback function.\n   *     @param {Error|null} error Error or `null` on success.\n   *     @param {Object} data Response data.\n   *     @param {Integer} status Response status code.\n   *     @param {Object} headers Response headers.\n   * @api private\n   */\n\n  _do: function (options) {\n    var self = this;\n    var key, value;\n\n    // create request\n    var req = request(options.method, options.uri);\n\n    // query string\n    if (options.query) {\n      // ensure query Array values are JSON encoded\n      for (key in options.query) {\n        if (typeof(value = options.query[key]) === \"object\") {\n          options.query[key] = JSON.stringify(value);\n        }\n      }\n      // set query on request\n      req.query(options.query);\n    }\n\n    // set headers\n    if (options.headers) {\n      req.set(options.headers);\n      // if authenticating\n      if (req.withCredentials && options.headers[\"Authorization\"] != null) {\n        req.withCredentials();\n      }\n    }\n\n    // send body\n    if (options.body) req.send(options.body);\n\n    // send request\n    var fn = options.fn;\n    req.end(function (res) {\n      var err = res.error;\n      var data;\n\n      if (!err) {\n        if (!(data = res.body || res.text)) {}\n        else if (data.error) err = self._error(data);\n        else data = self._response(data);\n      }\n\n      fn && fn(err || null, data, res.status, res.header, res);\n    });\n\n    return req;\n  },\n\n  /**\n   * Coerce response to normalize access to `_id` and `_rev`.\n   *\n   * @param {Object} json The response JSON.\n   * @return The coerced JSON.\n   * @api private\n   */\n\n  _response: function (json) {\n    var data = json.rows || json.results || json.uuids || isArray(json) && json;\n    var meta = this._meta;\n    var i = 0, len, item;\n\n    if (data) {\n      extend(data, json).json = json;\n      for (len = data.length; i < len; i++) {\n        item = data[i] = meta(data[i]);\n        if (item.doc) item.doc = meta(item.doc);\n      }\n    } else {\n      data = meta(json);\n    }\n\n    return data;\n  },\n\n  /**\n   * Make an error out of the response.\n   *\n   * @param {Object} json The response JSON.\n   * @return An `Error` object.\n   * @api private\n   */\n\n  _error: function (json) {\n    var err = new Error(json.reason);\n    err.code = json.error;\n    return extend(err, json);\n  },\n\n  /**\n   * JSON stringify functions. Used for encoding view documents to JSON.\n   *\n   * @param {String} key The key to stringify.\n   * @param {Object} val The value to stringify.\n   * @return {Object} The stringified function value or the value.\n   * @api private\n   */\n\n  _replacer: function (key, val) {\n    return isFunction (val) ? val.toString() : val;\n  },\n\n  /**\n   * Coerce documents with prototypical `_id` and `_rev`\n   * values.\n   *\n   * @param {Object} doc The document to coerce.\n   * @return {Object} The coerced document.\n   * @api private\n   */\n\n  _meta: function (doc) {\n    var hasId = !doc._id && doc.id;\n    var hasRev = !doc._rev && doc.rev;\n    var proto;\n\n    if (hasId || hasRev) {\n      proto = function (){};\n      doc = extend(new proto(), doc);\n      proto = proto.prototype;\n      if (hasId) proto._id = doc.id;\n      if (hasRev) proto._rev = doc.rev;\n    }\n\n    return doc;\n  },\n\n  /**\n   * HTTP headers to parse.\n   *\n   * @api private\n   */\n\n  _headers: [\n    \"cache-control\",\n    \"content-length\",\n    \"content-type\",\n    \"date\",\n    \"etag\",\n    \"server\"\n  ],\n\n  /**\n   * Parse arguments.\n   *\n   * @param {Array} args The arguments.\n   * @param {Integer} start The index from which to start reading arguments.\n   * @param {Boolean} withDoc Set to `true` if the doc source is given as a\n   *   parameter before HTTP query options.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @api private\n   */\n\n  _: function (args, start, withDoc) {\n    var self = this, doc, id, rev;\n\n    function request(method, path, options) {\n      if (!options) options = {};\n      return self._request({\n        method: method,\n        path: path || request.p,\n        query: options.q || request.q,\n        data: options.b || request.b,\n        headers: options.h || request.h,\n        fn: options.f || request.f,\n        _: options._ || request._\n      });\n    }\n\n    // [id], [doc], [query], [header], [callback]\n    args = [].slice.call(args, start || 0);\n\n    request.f = isFunction(args[args.length - 1]) && args.pop();\n    request.p = isString(args[0]) && encodeURI(args.shift());\n    request.q = args[withDoc ? 1 : 0] || {};\n    request.h = args[withDoc ? 2 : 1] || {};\n\n    if (withDoc) {\n      if (doc = (request.b = args[0])) {\n        if (id = request.p || doc._id || doc.id) request.p = id;\n        if (rev = request.q.rev || doc._rev || doc.rev) request.q.rev = rev;\n      }\n    }\n\n    return request;\n  }\n\n};\n\n/**\n * Clerk CouchDB client.\n *\n * @param {String} uri Fully qualified URI.\n * @param {String} [auth] Authentication header value.\n * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/Complete_HTTP_API_Reference)\n */\n\nclerk.Client = function (uri, auth) {\n  this.uri = uri;\n  this._db = {};\n  this.auth = auth;\n};\n\nclerk.Client.prototype = extend(new clerk.Base(), {\n\n  /**\n   * Select database to manipulate.\n   *\n   * @param {String} name DB name.\n   * @return {DB} DB object.\n   */\n\n  db: function (name) {\n    var db = this._db;\n    return db[name] || (db[name] = new clerk.DB(this, name, this.auth));\n  },\n\n  /**\n   * List all databases.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetAllDbs)\n   */\n\n  dbs: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\", \"_all_dbs\");\n  },\n\n  /**\n   * Get UUIDs.\n   *\n   * @param {Integer} [count=1] Number of UUIDs to get.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetUuids)\n   */\n\n  uuids: function (count /* [query], [headers], [callback] */) {\n    var request = this._(arguments, +count == count ? 1 : 0);\n    if (count > 1) request.q.count = count;\n    return request(\"GET\", \"_uuids\");\n  },\n\n  /**\n   * Get server information.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetRoot)\n   */\n\n  info: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\");\n  },\n\n  /**\n   * Get server stats.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetLog)\n   */\n\n  stats: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\", \"_stats\");\n  },\n\n  /**\n   * Get tail of the server log file.\n   *\n   * @param {Object} [query] Query parameters.\n   *   @param {Integer} [query.bytes=1000] Number of bytes to read.\n   *   @param {Integer} [query.offset=0] Number of bytes from the end of\n   *     log file to start reading.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetLog)\n   */\n\n  log: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\", \"_log\");\n  },\n\n  /**\n   * List running tasks.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetActiveTasks)\n   */\n\n  tasks: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\", \"_active_tasks\");\n  },\n\n  /**\n   * Get or set configuration values.\n   *\n   * @param {String} [key] Configuration section or key.\n   * @param {String} [value] Configuration value.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  config: function (/* [key], [value], [query], [headers], [callback] */) {\n    var args = [].slice.call(arguments);\n    var key = isString(args[0]) && args.shift() || \"\";\n    var value = isString(args[0]) && args.shift();\n    var method = isString(value) ? \"PUT\" : \"GET\";\n    return this._(args)(method, \"_config/\" + key, { b: value });\n  },\n\n  /**\n   * Replicate databases.\n   *\n   * @param {Object} options Options.\n   *   @param {String} options.source Source database URL or local name.\n   *   @param {String} options.target Target database URL or local name.\n   *   @param {Boolean} [options.cancel] Set to `true` to cancel replication.\n   *   @param {Boolean} [options.continuous] Set to `true` for continuous\n   *     replication.\n   *   @param {Boolean} [options.create_target] Set to `true` to create the\n   *     target database.\n   *   @param {String} [options.filter] Filter name for filtered replication.\n   *     Example: \"mydesign/myfilter\".\n   *   @param {Object} [options.query] Query parameters for filter.\n   *   @param {String[]} [options.doc_ids] Document IDs to replicate.\n   *   @param {String} [options.proxy] Proxy through which to replicate.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/Replication)\n   */\n\n  replicate: function (options /* [query], [headers], [callback] */) {\n    return this._(arguments, 1)(\"POST\", \"_replicate\", { b: options });\n  }\n\n});\n\n/**\n * Methods for CouchDB database.\n *\n * @param {Client} client Clerk client.\n * @param {String} name DB name.\n * @param {String} [auth] Authentication header value.\n * @return This object for chaining.\n */\n\nclerk.DB = function (client, name, auth) {\n  this.client = client;\n  this.name = name;\n  this.uri = client.uri + \"/\" + encodeURIComponent(name);\n  this.auth = auth;\n};\n\nclerk.DB.prototype = extend(new clerk.Base(), {\n\n  /**\n   * Create database.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  create: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"PUT\");\n  },\n\n  /**\n   * Destroy database.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  destroy: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"DELETE\");\n  },\n\n  /**\n   * Get database info.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  info: function (/* [query], [headers], callback */) {\n    return this._(arguments)(\"GET\");\n  },\n\n  /**\n   * Check if database exists.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  exists: function (/* [query], [headers], callback */) {\n    var request = this._(arguments);\n    request._ = function (err, body, status, headers, req) {\n      return [err, status === 200, status, headers, req];\n    };\n    return request(\"HEAD\");\n  },\n\n  /**\n   * Fetch document.\n   *\n   * Set `rev` in `query`.\n   *\n   * @param {String} id Document ID.\n   * @param {Object} [query] HTTP query options.\n   *   @param {Boolean} [query.revs] Fetch list of revisions.\n   *   @param {Boolean} [query.revs_info] Fetch detailed revision information.\n   * @param {Function} callback Callback function.\n   *   @param {Error|null} error Error or `null` on success.\n   *   @param {Object} data Response data.\n   *   @param {Integer} status Response status code.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#GET)\n   */\n\n  get: function (/* [id], [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\");\n  },\n\n  /**\n   * Get document metadata.\n   *\n   * @param {String} id Document ID.\n   * @param {Object} [query] HTTP query options.\n   * @param {Function} callback Callback function.\n   *   @param {Error|null} callback.error Error or `null` on success.\n   *   @param {Object|Object[]} [callback.body] Document metadata or array\n   *     of document metadata.\n   *     @param result.id Document ID.\n   *     @param result.rev Document revision.\n   *     @param [result.contentType] MIME content type. Only available when\n   *       getting metadata for single document.\n   *     @param [result.contentLength] Content length. Only available when\n   *       getting metadata for single document.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#HEAD)\n   */\n\n  head: function (/* [id], [query], [headers], callback */) {\n    var self = this;\n    var request = self._(arguments);\n    request._ = function (err, body, status, headers, res) {\n      return [err, err ? null : {\n        _id: request.p,\n        _rev: headers.etag && JSON.parse(headers.etag),\n        contentType: headers[\"content-type\"],\n        contentLength: headers[\"content-length\"]\n      }, status, headers, res];\n    };\n    return request(\"HEAD\");\n  },\n\n  /**\n   * Post document(s) to database.\n   *\n   * If documents have no ID, a document ID will be automatically generated\n   * on the server. If attachments are given, they will be automatically\n   * Base64 encoded. Streamed attachments are not supported. Attachments are\n   * only supported on Node.js.\n   *\n   * @param {Object} doc Document.\n   *   @param {String} [doc._id] Document ID. If set, uses given document ID.\n   *   @param {String} [doc._rev] Document revision. If set, allows update to\n   *     existing document.\n   *   @param {Object} [doc._attachments] Attachments. If given, must be a\n   *     map of filenames to attachment properties.\n   *     @param {String} [doc._attachments[filename]] Attachment filename, as\n   *       hash key.\n   *     @param {String} [doc._attachments[filename].contentType] Attachment\n   *       MIME content type.\n   *     @param {String|Object} [doc._attachments[filename].data] Attachment\n   *       data. Will be Base64 encoded.\n   * @param {Object} [query] HTTP query options.\n   *   @param {Boolean} [query.batch] Allow server to write document in\n   *     batch mode. Documents will not be written to disk immediately,\n   *     increasing the chances of write failure.\n   *   @param {Boolean} [query.all_or_nothing] For batch updating of\n   *     documents, use all-or-nothing semantics.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#POST)\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Bulk_Document_API)\n   */\n\n  post: function (docs /* [query], [headers], [callback] */) {\n    var request = this._(arguments, 1);\n    if (isArray(docs)) {\n      request.p = \"_bulk_docs\";\n      request.b = extend({ docs: docs }, request.q);\n      request.q = null\n    } else {\n      request.b = docs;\n    }\n    return request(\"POST\");\n  },\n\n  /**\n   * Put document in database.\n   *\n   * @param {Object} doc Document data. Requires `id` and `rev`.\n   * @param {String} [options] Options.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#PUT)\n   */\n\n  put: function (/* [id], [doc], [query], [headers], [callback] */) {\n    var request = this._(arguments, 0, 1);\n    // prevent acidentally creating database\n    if (!request.p) request.p = request.b._id || request.b.id;\n    if (!request.p) throw new Error(\"missing id\");\n    return request(\"PUT\");\n  },\n\n  /**\n   * Delete document(s).\n   *\n   * @param {String} doc Document or document ID.\n   * @param {Object} [query] HTTP query options.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#DELETE)\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Bulk_Document_API)\n   */\n\n  del: function (docs /* [query], [headers], [callback] */) {\n    if (isArray(docs)) {\n      var i = 0, len = docs.length, doc;\n      for (; i < len; i++) {\n        doc = docs[i], docs[i] = {\n          _id: doc._id || doc.id,\n          _rev: doc._rev || doc.rev,\n          _deleted: true\n        };\n      }\n      return this.post.apply(this, arguments);\n    } else {\n      var request = this._(arguments, 0, 1);\n      // prevent acidentally deleting database\n      if (!request.p) throw new Error(\"missing id\");\n      return request(\"DELETE\");\n    }\n  },\n\n  /**\n   * Copy document.\n   *\n   * @param {Object} source Source document.\n   *   @param {String} source.id Source document ID.\n   *   @param {String} [source.rev] Source document revision.\n   *   @param {String} [source._id] Source document ID. Alternate key for\n   *     `source.id`.\n   *   @param {String} [source._rev] Source document revision. Alternate key\n   *     for `source.id`.\n   * @param {Object} target Target document.\n   *   @param {String} target.id Target document ID.\n   *   @param {String} [target.rev] Target document revision.\n   *   @param {String} [target._id] Target document ID. Alternate key for\n   *     `target.id`.\n   *   @param {String} [target._rev] Target document revision. Alternate key\n   *     for `target.id`.\n   * @param {Object} [query] HTTP query options.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#COPY)\n   */\n\n  copy: function (source, target /* [query], [headers], [callback] */) {\n    var request = this._(arguments, 2);\n    var sourcePath = encodeURIComponent(source.id || source._id || source);\n    var targetPath = encodeURIComponent(target.id || target._id || target);\n    var sourceRev = source.rev || source._rev;\n    var targetRev = target.rev || target._rev;\n\n    if (sourceRev) request.q.rev = sourceRev;\n    if (targetRev) targetPath += \"?rev=\" + encodeURIComponent(targetRev);\n\n    request.h.Destination = targetPath;\n\n    return request(\"COPY\", sourcePath);\n  },\n\n  /**\n   * Query all documents by ID.\n   *\n   * @param {Object} [query] HTTP query options.\n   *   @param {JSON} [query.startkey] Start returning results from this\n   *     document ID.\n   *   @param {JSON} [query.endkey] Stop returning results at this document\n   *     ID.\n   *   @param {Integer} [query.limit] Limit number of results returned.\n   *   @param {Boolean} [query.descending=false] Lookup results in reverse\n   *     order by key, returning documents in descending order by key.\n   *   @param {Integer} [query.skip] Skip this many records before\n   *     returning results.\n   *   @param {Boolean} [query.include_docs=false] Include document source for\n   *     each result.\n   *   @param {Boolean} [query.include_end=true] Include `query.endkey`\n   *     in results.\n   *   @param {Boolean} [query.update_seq=false] Include sequence value\n   *     of the database corresponding to the view.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Bulk_Document_API)\n   */\n\n  all: function (/* [query], [headers], [callback] */) {\n    var request = this._(arguments);\n    var body = this._viewOptions(request.q);\n    return request(body ? \"POST\" : \"GET\", \"_all_docs\", { b: body });\n  },\n\n  /**\n   * Query a view.\n   *\n   * @param {String|Object} view View name (e.g. mydesign/myview) or\n   *   temporary view definition. Using a temporary view is strongly not\n   *   recommended for production use.\n   * @param {Object} [query] HTTP query options.\n   *   @param {JSON} [query.key] Key to lookup.\n   *   @param {JSON} [query.startkey] Start returning results from this key.\n   *   @param {String} [query.startkey_docid] Start returning results\n   *     from this document ID. Allows pagination with duplicate keys.\n   *   @param {JSON} [query.endkey] Stop returning results at this key.\n   *   @param {String} [query.endkey_docid] Stop returning results at\n   *     this document ID. Allows pagination with duplicate keys.\n   *   @param {Integer} [query.limit] Limit number of results returned.\n   *   @param {Boolean|String} [query.stale] Do not refresh view even if\n   *     stale. For CouchDB versions `1.1.0` and up, set to `update_after` to\n   *     update view after results are returned.\n   *   @param {Boolean} [query.descending=false] Lookup results in reverse\n   *     order by key, returning documents in descending order by key.\n   *   @param {Integer} [query.skip] Skip this many records before\n   *     returning results.\n   *   @param {Boolean|Integer} [query.group=false] Use the reduce function\n   *     to group results by key. Set to an integer specify `group_level`.\n   *   @param {Boolean|Integer} [query.reduce=true] Use the reduce function.\n   *   @param {Boolean} [query.fetch=false] Include document source for\n   *     each result.\n   *   @param {Boolean} [query.include_end=true] Include `query.endkey`\n   *     in results.\n   *   @param {Boolean} [query.update_seq=false] Include sequence value\n   *     of the database corresponding to the view.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_view_API)\n   */\n\n  find: function (view /* [query], [headers], [callback] */) {\n    var request = this._(arguments, 1), path, body;\n\n    if (isString(view)) {\n      path = view.split(\"/\", 2);\n      path = \"_design/\" + encodeURIComponent(path[0]) +\n             \"/_view/\" + encodeURIComponent(path[1]);\n    } else {\n      path = \"_temp_view\";\n      body = view;\n    }\n\n    body = this._viewOptions(request.q, body);\n    return request(body ? \"POST\" : \"GET\", path, { b: body });\n  },\n\n  /**\n   * Get database changes.\n   *\n   * The `feed` option determines how the callback is called:\n   *\n   *   - `normal` calls the callback once.\n   *   - `longpoll` waits for a response, then calls the callback once.\n   *   - `continuous` calls the callback each time an update is received.\n   *     Implemented as the `database#follow()` method.\n   *\n   * @param {Object} [query] HTTP query options.\n   *   @param {String} [query.feed=\"normal\"] Type of feed. See comments\n   *     above.\n   *   @param {String} [query.filter] Filter updates using this filter.\n   *   @param {Integer} [query.limit] Maximum number of rows to return.\n   *   @param {Integer} [query.since=0] Start results from this sequence\n   *     number.\n   *   @param {Boolean} [query.include_docs=false] Include documents with\n   *     results.\n   *   @param {Integer} [query.timeout=1000] Maximum period in milliseconds\n   *     to wait for a change before sending a response, even if there are no\n   *     results.\n   *   @param {Integer} [query.heartbeat=1000] Period in milliseconds after\n   *     which an empty line is sent. Applicable only to feed types\n   *     `longpoll` and `continuous`. Overrides `query.timeout` to keep the\n   *     feed alive indefinitely.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_database_API#Changes)\n   */\n\n  changes: function (/* [query], [headers], [callback] */) {\n    var request = this._(arguments);\n    if (request.q.feed != \"longpoll\") delete request.q.feed;\n    return this._changes(request);\n  },\n\n  /**\n   * Get database changes.\n   *\n   * @see `#changes()`.\n   */\n\n  follow: function (/* [query], [headers], callback */) {\n    var request = this._(arguments);\n    var fn = request.f;\n\n    if (!fn) return this;\n\n    request.q.feed = \"longpoll\";\n    request.f = function (err, body) {\n      var args = [].slice.call(arguments);\n      var done, i;\n      for (i = 0; i < body.length; i++) {\n        args[1] = body[i];\n        if (done = fn.apply(this, args) === false || err) break;\n      }\n      if (!done) this._changes(request);\n    };\n\n    return this._changes(request);\n  },\n\n  /**\n   * Service a changes request.\n   *\n   * @api private\n   */\n\n  _changes: function (request) {\n    return request(\"GET\", \"_changes\");\n  },\n\n  /**\n   * Update document using server-side handler.\n   *\n   * @param {String} handler Update handler. Example: mydesign/myhandler\n   * @param {String} [id] Document ID.\n   * @param {Object} [query] HTTP query options.\n   * @param {Object|String} [data] Data.\n   * @param {Object} [headers] Headers.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/Document_Update_Handlers)\n   */\n\n  update: function (handler /* [id], [query], [data], [headers], [callback] */) {\n    var request = this._(arguments, 1, 1);\n    var path = handler.split(\"/\", 2);\n\n    path = \"_design/\" + encodeURIComponent(path[0]) +\n           \"/_update/\" + encodeURIComponent(path[1]);\n\n    if (request.p) path += \"/\" + request.p;\n\n    return request(request.p ? \"PUT\" : \"POST\", path, {\n      q: request.b,\n      b: request.q\n    });\n  },\n\n  /**\n   * Download attachment from document.\n   *\n   * @param {Object|String} docOrId Document or document ID.\n   * @param {String} attachmentName Attachment name.\n   * @param {Object} [query] HTTP query options.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  attachment: function (doc, attachmentName /* [query], [headers], [callback] */) {\n    var request = this._(arguments, 2);\n    var path = encodeURIComponent(doc._id || doc.id || doc) + \"/\" +\n               encodeURIComponent(attachmentName);\n    return request(\"GET\", path, options);\n  },\n\n  /**\n   * Upload attachment to document.\n   *\n   * Set the `Content-Type` header.\n   *\n   * @param {Object} [doc] Document. Requires `id`. `rev` can be specified\n   *   here or in `query`.\n   * @param {String} attachmentName Attachment name.\n   * @param {Object} data Data.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  attach: function (doc, attachmentName, data /* [query], [headers], [callback] */) {\n    var request = this._(arguments, 3);\n    request.p = encodeURIComponent(doc._id || doc.id) + \"/\" +\n                encodeURIComponent(attachmentName);\n    if (!request.q.rev) request.q.rev = doc._rev || doc.rev;\n    request.q.body = data;\n    return request(\"PUT\", path);\n  },\n\n  /**\n   * Replicate database.\n   *\n   * This convenience function sets `options.source` and `options.target` to\n   * the selected database name. Either `options.source` or `options.target`\n   * must be overridden for a successful replication request.\n   *\n   * @param {Options} options Options. Accepts all options from\n   *   `Client.replicate()`.\n   *   @param {String} [options.source=this.name] Source database URL or\n   *     local name. Defaults to the selected database name if not given.\n   *   @param {String} [options.target=this.name] Target database URL or\n   *     local name. Defaults to the selected database name if not given.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  replicate: function (options /* [query], [headers], [callback] */) {\n    if (!options.source) options.source = this.name;\n    if (!options.target) options.target = this.name;\n    return this.client.replicate.apply(this.client, arguments);\n  },\n\n  /**\n   * Ensure recent changes are committed to disk.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  commit: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"POST\", \"_ensure_full_commit\");\n  },\n\n  /**\n   * Purge deleted documents from database.\n   *\n   * @param {Object} revs Map of document IDs to revisions to be purged.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  purge: function (revs /* [query], [headers], [callback] */) {\n    return this._(arguments, 1)(\"POST\", \"_purge\", { b: revs });\n  },\n\n  /**\n   * Compact database or design.\n   *\n   * @param {String} [design] Design name if compacting design indexes.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/Compaction)\n   */\n\n  compact: function (/* [design], [query], [headers], [callback] */) {\n    var request = this._(arguments);\n    return request(\"POST\", \"_compact/\" + (request.p || \"\"));\n  },\n\n  /**\n   * Remove unused views.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/Compaction)\n   */\n\n  vacuum: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"POST\", \"_view_cleanup\");\n  },\n\n  /**\n   * Parse view options.\n   *\n   * @param {Object} query The HTTP query options.\n   * @param {Object} body The body payload.\n   * @return {Object} The body payload.\n   * @api private\n   */\n\n  _viewOptions: function (q, body) {\n    if (q) {\n      if (q.key) q.key = JSON.stringify(q.key);\n      if (q.startkey) q.startkey = JSON.stringify(q.startkey);\n      if (q.endkey) q.endkey = JSON.stringify(q.endkey);\n      if (q.stale && q.stale != \"update_after\") q.stale = \"ok\";\n      if (q.keys) {\n        if (!body) body = {};\n        body.keys = q.keys;\n        delete q.keys;\n      }\n    }\n    return body;\n  }\n\n});\n\n/**\n * Export clerk.\n */\n\nmodule.exports = clerk;\n\n\n/***/ },\n/* 1 */\n/***/ function(module, exports, __webpack_require__) {\n\n/**\n * Module dependencies.\n */\n\nvar Emitter = __webpack_require__(2);\nvar reduce = __webpack_require__(3);\n\n/**\n * Root reference for iframes.\n */\n\nvar root = 'undefined' == typeof window\n  ? this\n  : window;\n\n/**\n * Noop.\n */\n\nfunction noop(){};\n\n/**\n * Check if `obj` is a host object,\n * we don't want to serialize these :)\n *\n * TODO: future proof, move to compoent land\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isHost(obj) {\n  var str = {}.toString.call(obj);\n\n  switch (str) {\n    case '[object File]':\n    case '[object Blob]':\n    case '[object FormData]':\n      return true;\n    default:\n      return false;\n  }\n}\n\n/**\n * Determine XHR.\n */\n\nfunction getXHR() {\n  if (root.XMLHttpRequest\n    && ('file:' != root.location.protocol || !root.ActiveXObject)) {\n    return new XMLHttpRequest;\n  } else {\n    try { return new ActiveXObject('Microsoft.XMLHTTP'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.6.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.3.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP'); } catch(e) {}\n  }\n  return false;\n}\n\n/**\n * Removes leading and trailing whitespace, added to support IE.\n *\n * @param {String} s\n * @return {String}\n * @api private\n */\n\nvar trim = ''.trim\n  ? function(s) { return s.trim(); }\n  : function(s) { return s.replace(/(^\\s*|\\s*$)/g, ''); };\n\n/**\n * Check if `obj` is an object.\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Serialize the given `obj`.\n *\n * @param {Object} obj\n * @return {String}\n * @api private\n */\n\nfunction serialize(obj) {\n  if (!isObject(obj)) return obj;\n  var pairs = [];\n  for (var key in obj) {\n    if (null != obj[key]) {\n      pairs.push(encodeURIComponent(key)\n        + '=' + encodeURIComponent(obj[key]));\n    }\n  }\n  return pairs.join('&');\n}\n\n/**\n * Expose serialization method.\n */\n\n request.serializeObject = serialize;\n\n /**\n  * Parse the given x-www-form-urlencoded `str`.\n  *\n  * @param {String} str\n  * @return {Object}\n  * @api private\n  */\n\nfunction parseString(str) {\n  var obj = {};\n  var pairs = str.split('&');\n  var parts;\n  var pair;\n\n  for (var i = 0, len = pairs.length; i < len; ++i) {\n    pair = pairs[i];\n    parts = pair.split('=');\n    obj[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1]);\n  }\n\n  return obj;\n}\n\n/**\n * Expose parser.\n */\n\nrequest.parseString = parseString;\n\n/**\n * Default MIME type map.\n *\n *     superagent.types.xml = 'application/xml';\n *\n */\n\nrequest.types = {\n  html: 'text/html',\n  json: 'application/json',\n  xml: 'application/xml',\n  urlencoded: 'application/x-www-form-urlencoded',\n  'form': 'application/x-www-form-urlencoded',\n  'form-data': 'application/x-www-form-urlencoded'\n};\n\n/**\n * Default serialization map.\n *\n *     superagent.serialize['application/xml'] = function(obj){\n *       return 'generated xml here';\n *     };\n *\n */\n\n request.serialize = {\n   'application/x-www-form-urlencoded': serialize,\n   'application/json': JSON.stringify\n };\n\n /**\n  * Default parsers.\n  *\n  *     superagent.parse['application/xml'] = function(str){\n  *       return { object parsed from str };\n  *     };\n  *\n  */\n\nrequest.parse = {\n  'application/x-www-form-urlencoded': parseString,\n  'application/json': JSON.parse\n};\n\n/**\n * Parse the given header `str` into\n * an object containing the mapped fields.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction parseHeader(str) {\n  var lines = str.split(/\\r?\\n/);\n  var fields = {};\n  var index;\n  var line;\n  var field;\n  var val;\n\n  lines.pop(); // trailing CRLF\n\n  for (var i = 0, len = lines.length; i < len; ++i) {\n    line = lines[i];\n    index = line.indexOf(':');\n    field = line.slice(0, index).toLowerCase();\n    val = trim(line.slice(index + 1));\n    fields[field] = val;\n  }\n\n  return fields;\n}\n\n/**\n * Return the mime type for the given `str`.\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nfunction type(str){\n  return str.split(/ *; */).shift();\n};\n\n/**\n * Return header field parameters.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction params(str){\n  return reduce(str.split(/ *; */), function(obj, str){\n    var parts = str.split(/ *= */)\n      , key = parts.shift()\n      , val = parts.shift();\n\n    if (key && val) obj[key] = val;\n    return obj;\n  }, {});\n};\n\n/**\n * Initialize a new `Response` with the given `xhr`.\n *\n *  - set flags (.ok, .error, etc)\n *  - parse header\n *\n * Examples:\n *\n *  Aliasing `superagent` as `request` is nice:\n *\n *      request = superagent;\n *\n *  We can use the promise-like API, or pass callbacks:\n *\n *      request.get('/').end(function(res){});\n *      request.get('/', function(res){});\n *\n *  Sending data can be chained:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' })\n *        .end(function(res){});\n *\n *  Or passed to `.send()`:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' }, function(res){});\n *\n *  Or passed to `.post()`:\n *\n *      request\n *        .post('/user', { name: 'tj' })\n *        .end(function(res){});\n *\n * Or further reduced to a single call for simple cases:\n *\n *      request\n *        .post('/user', { name: 'tj' }, function(res){});\n *\n * @param {XMLHTTPRequest} xhr\n * @param {Object} options\n * @api private\n */\n\nfunction Response(req, options) {\n  options = options || {};\n  this.req = req;\n  this.xhr = this.req.xhr;\n  this.text = this.req.method !='HEAD' \n     ? this.xhr.responseText \n     : null;\n  this.setStatusProperties(this.xhr.status);\n  this.header = this.headers = parseHeader(this.xhr.getAllResponseHeaders());\n  // getAllResponseHeaders sometimes falsely returns \"\" for CORS requests, but\n  // getResponseHeader still works. so we get content-type even if getting\n  // other headers fails.\n  this.header['content-type'] = this.xhr.getResponseHeader('content-type');\n  this.setHeaderProperties(this.header);\n  this.body = this.req.method != 'HEAD'\n    ? this.parseBody(this.text)\n    : null;\n}\n\n/**\n * Get case-insensitive `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api public\n */\n\nResponse.prototype.get = function(field){\n  return this.header[field.toLowerCase()];\n};\n\n/**\n * Set header related properties:\n *\n *   - `.type` the content type without params\n *\n * A response of \"Content-Type: text/plain; charset=utf-8\"\n * will provide you with a `.type` of \"text/plain\".\n *\n * @param {Object} header\n * @api private\n */\n\nResponse.prototype.setHeaderProperties = function(header){\n  // content-type\n  var ct = this.header['content-type'] || '';\n  this.type = type(ct);\n\n  // params\n  var obj = params(ct);\n  for (var key in obj) this[key] = obj[key];\n};\n\n/**\n * Parse the given body `str`.\n *\n * Used for auto-parsing of bodies. Parsers\n * are defined on the `superagent.parse` object.\n *\n * @param {String} str\n * @return {Mixed}\n * @api private\n */\n\nResponse.prototype.parseBody = function(str){\n  var parse = request.parse[this.type];\n  return parse && str && str.length\n    ? parse(str)\n    : null;\n};\n\n/**\n * Set flags such as `.ok` based on `status`.\n *\n * For example a 2xx response will give you a `.ok` of __true__\n * whereas 5xx will be __false__ and `.error` will be __true__. The\n * `.clientError` and `.serverError` are also available to be more\n * specific, and `.statusType` is the class of error ranging from 1..5\n * sometimes useful for mapping respond colors etc.\n *\n * \"sugar\" properties are also defined for common cases. Currently providing:\n *\n *   - .noContent\n *   - .badRequest\n *   - .unauthorized\n *   - .notAcceptable\n *   - .notFound\n *\n * @param {Number} status\n * @api private\n */\n\nResponse.prototype.setStatusProperties = function(status){\n  var type = status / 100 | 0;\n\n  // status / class\n  this.status = status;\n  this.statusType = type;\n\n  // basics\n  this.info = 1 == type;\n  this.ok = 2 == type;\n  this.clientError = 4 == type;\n  this.serverError = 5 == type;\n  this.error = (4 == type || 5 == type)\n    ? this.toError()\n    : false;\n\n  // sugar\n  this.accepted = 202 == status;\n  this.noContent = 204 == status || 1223 == status;\n  this.badRequest = 400 == status;\n  this.unauthorized = 401 == status;\n  this.notAcceptable = 406 == status;\n  this.notFound = 404 == status;\n  this.forbidden = 403 == status;\n};\n\n/**\n * Return an `Error` representative of this response.\n *\n * @return {Error}\n * @api public\n */\n\nResponse.prototype.toError = function(){\n  var req = this.req;\n  var method = req.method;\n  var url = req.url;\n\n  var msg = 'cannot ' + method + ' ' + url + ' (' + this.status + ')';\n  var err = new Error(msg);\n  err.status = this.status;\n  err.method = method;\n  err.url = url;\n\n  return err;\n};\n\n/**\n * Expose `Response`.\n */\n\nrequest.Response = Response;\n\n/**\n * Initialize a new `Request` with the given `method` and `url`.\n *\n * @param {String} method\n * @param {String} url\n * @api public\n */\n\nfunction Request(method, url) {\n  var self = this;\n  Emitter.call(this);\n  this._query = this._query || [];\n  this.method = method;\n  this.url = url;\n  this.header = {};\n  this._header = {};\n  this.on('end', function(){\n    var err = null;\n    var res = null;\n\n    try {\n      res = new Response(self); \n    } catch(e) {\n      err = new Error('Parser is unable to parse the response');\n      err.parse = true;\n      err.original = e;\n    }\n\n    self.callback(err, res);\n  });\n}\n\n/**\n * Mixin `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Allow for extension\n */\n\nRequest.prototype.use = function(fn) {\n  fn(this);\n  return this;\n}\n\n/**\n * Set timeout to `ms`.\n *\n * @param {Number} ms\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.timeout = function(ms){\n  this._timeout = ms;\n  return this;\n};\n\n/**\n * Clear previous timeout.\n *\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.clearTimeout = function(){\n  this._timeout = 0;\n  clearTimeout(this._timer);\n  return this;\n};\n\n/**\n * Abort the request, and clear potential timeout.\n *\n * @return {Request}\n * @api public\n */\n\nRequest.prototype.abort = function(){\n  if (this.aborted) return;\n  this.aborted = true;\n  this.xhr.abort();\n  this.clearTimeout();\n  this.emit('abort');\n  return this;\n};\n\n/**\n * Set header `field` to `val`, or multiple fields with one object.\n *\n * Examples:\n *\n *      req.get('/')\n *        .set('Accept', 'application/json')\n *        .set('X-API-Key', 'foobar')\n *        .end(callback);\n *\n *      req.get('/')\n *        .set({ Accept: 'application/json', 'X-API-Key': 'foobar' })\n *        .end(callback);\n *\n * @param {String|Object} field\n * @param {String} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.set = function(field, val){\n  if (isObject(field)) {\n    for (var key in field) {\n      this.set(key, field[key]);\n    }\n    return this;\n  }\n  this._header[field.toLowerCase()] = val;\n  this.header[field] = val;\n  return this;\n};\n\n/**\n * Remove header `field`.\n *\n * Example:\n *\n *      req.get('/')\n *        .unset('User-Agent')\n *        .end(callback);\n *\n * @param {String} field\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.unset = function(field){\n  delete this._header[field.toLowerCase()];\n  delete this.header[field];\n  return this;\n};\n\n/**\n * Get case-insensitive header `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api private\n */\n\nRequest.prototype.getHeader = function(field){\n  return this._header[field.toLowerCase()];\n};\n\n/**\n * Set Content-Type to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.xml = 'application/xml';\n *\n *      request.post('/')\n *        .type('xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n *      request.post('/')\n *        .type('application/xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n * @param {String} type\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.type = function(type){\n  this.set('Content-Type', request.types[type] || type);\n  return this;\n};\n\n/**\n * Set Accept to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.json = 'application/json';\n *\n *      request.get('/agent')\n *        .accept('json')\n *        .end(callback);\n *\n *      request.get('/agent')\n *        .accept('application/json')\n *        .end(callback);\n *\n * @param {String} accept\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.accept = function(type){\n  this.set('Accept', request.types[type] || type);\n  return this;\n};\n\n/**\n * Set Authorization field value with `user` and `pass`.\n *\n * @param {String} user\n * @param {String} pass\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.auth = function(user, pass){\n  var str = btoa(user + ':' + pass);\n  this.set('Authorization', 'Basic ' + str);\n  return this;\n};\n\n/**\n* Add query-string `val`.\n*\n* Examples:\n*\n*   request.get('/shoes')\n*     .query('size=10')\n*     .query({ color: 'blue' })\n*\n* @param {Object|String} val\n* @return {Request} for chaining\n* @api public\n*/\n\nRequest.prototype.query = function(val){\n  if ('string' != typeof val) val = serialize(val);\n  if (val) this._query.push(val);\n  return this;\n};\n\n/**\n * Write the field `name` and `val` for \"multipart/form-data\"\n * request bodies.\n *\n * ``` js\n * request.post('/upload')\n *   .field('foo', 'bar')\n *   .end(callback);\n * ```\n *\n * @param {String} name\n * @param {String|Blob|File} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.field = function(name, val){\n  if (!this._formData) this._formData = new FormData();\n  this._formData.append(name, val);\n  return this;\n};\n\n/**\n * Queue the given `file` as an attachment to the specified `field`,\n * with optional `filename`.\n *\n * ``` js\n * request.post('/upload')\n *   .attach(new Blob(['<a id=\"a\"><b id=\"b\">hey!</b></a>'], { type: \"text/html\"}))\n *   .end(callback);\n * ```\n *\n * @param {String} field\n * @param {Blob|File} file\n * @param {String} filename\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.attach = function(field, file, filename){\n  if (!this._formData) this._formData = new FormData();\n  this._formData.append(field, file, filename);\n  return this;\n};\n\n/**\n * Send `data`, defaulting the `.type()` to \"json\" when\n * an object is given.\n *\n * Examples:\n *\n *       // querystring\n *       request.get('/search')\n *         .end(callback)\n *\n *       // multiple data \"writes\"\n *       request.get('/search')\n *         .send({ search: 'query' })\n *         .send({ range: '1..5' })\n *         .send({ order: 'desc' })\n *         .end(callback)\n *\n *       // manual json\n *       request.post('/user')\n *         .type('json')\n *         .send('{\"name\":\"tj\"})\n *         .end(callback)\n *\n *       // auto json\n *       request.post('/user')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // manual x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send('name=tj')\n *         .end(callback)\n *\n *       // auto x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // defaults to x-www-form-urlencoded\n  *      request.post('/user')\n  *        .send('name=tobi')\n  *        .send('species=ferret')\n  *        .end(callback)\n *\n * @param {String|Object} data\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.send = function(data){\n  var obj = isObject(data);\n  var type = this.getHeader('Content-Type');\n\n  // merge\n  if (obj && isObject(this._data)) {\n    for (var key in data) {\n      this._data[key] = data[key];\n    }\n  } else if ('string' == typeof data) {\n    if (!type) this.type('form');\n    type = this.getHeader('Content-Type');\n    if ('application/x-www-form-urlencoded' == type) {\n      this._data = this._data\n        ? this._data + '&' + data\n        : data;\n    } else {\n      this._data = (this._data || '') + data;\n    }\n  } else {\n    this._data = data;\n  }\n\n  if (!obj) return this;\n  if (!type) this.type('json');\n  return this;\n};\n\n/**\n * Invoke the callback with `err` and `res`\n * and handle arity check.\n *\n * @param {Error} err\n * @param {Response} res\n * @api private\n */\n\nRequest.prototype.callback = function(err, res){\n  var fn = this._callback;\n  this.clearTimeout();\n  if (2 == fn.length) return fn(err, res);\n  if (err) return this.emit('error', err);\n  fn(res);\n};\n\n/**\n * Invoke callback with x-domain error.\n *\n * @api private\n */\n\nRequest.prototype.crossDomainError = function(){\n  var err = new Error('Origin is not allowed by Access-Control-Allow-Origin');\n  err.crossDomain = true;\n  this.callback(err);\n};\n\n/**\n * Invoke callback with timeout error.\n *\n * @api private\n */\n\nRequest.prototype.timeoutError = function(){\n  var timeout = this._timeout;\n  var err = new Error('timeout of ' + timeout + 'ms exceeded');\n  err.timeout = timeout;\n  this.callback(err);\n};\n\n/**\n * Enable transmission of cookies with x-domain requests.\n *\n * Note that for this to work the origin must not be\n * using \"Access-Control-Allow-Origin\" with a wildcard,\n * and also must set \"Access-Control-Allow-Credentials\"\n * to \"true\".\n *\n * @api public\n */\n\nRequest.prototype.withCredentials = function(){\n  this._withCredentials = true;\n  return this;\n};\n\n/**\n * Initiate request, invoking callback `fn(res)`\n * with an instanceof `Response`.\n *\n * @param {Function} fn\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.end = function(fn){\n  var self = this;\n  var xhr = this.xhr = getXHR();\n  var query = this._query.join('&');\n  var timeout = this._timeout;\n  var data = this._formData || this._data;\n\n  // store callback\n  this._callback = fn || noop;\n\n  // state change\n  xhr.onreadystatechange = function(){\n    if (4 != xhr.readyState) return;\n    if (0 == xhr.status) {\n      if (self.aborted) return self.timeoutError();\n      return self.crossDomainError();\n    }\n    self.emit('end');\n  };\n\n  // progress\n  if (xhr.upload) {\n    xhr.upload.onprogress = function(e){\n      e.percent = e.loaded / e.total * 100;\n      self.emit('progress', e);\n    };\n  }\n\n  // timeout\n  if (timeout && !this._timer) {\n    this._timer = setTimeout(function(){\n      self.abort();\n    }, timeout);\n  }\n\n  // querystring\n  if (query) {\n    query = request.serializeObject(query);\n    this.url += ~this.url.indexOf('?')\n      ? '&' + query\n      : '?' + query;\n  }\n\n  // initiate request\n  xhr.open(this.method, this.url, true);\n\n  // CORS\n  if (this._withCredentials) xhr.withCredentials = true;\n\n  // body\n  if ('GET' != this.method && 'HEAD' != this.method && 'string' != typeof data && !isHost(data)) {\n    // serialize stuff\n    var serialize = request.serialize[this.getHeader('Content-Type')];\n    if (serialize) data = serialize(data);\n  }\n\n  // set header fields\n  for (var field in this.header) {\n    if (null == this.header[field]) continue;\n    xhr.setRequestHeader(field, this.header[field]);\n  }\n\n  // send stuff\n  this.emit('request', this);\n  xhr.send(data);\n  return this;\n};\n\n/**\n * Expose `Request`.\n */\n\nrequest.Request = Request;\n\n/**\n * Issue a request:\n *\n * Examples:\n *\n *    request('GET', '/users').end(callback)\n *    request('/users').end(callback)\n *    request('/users', callback)\n *\n * @param {String} method\n * @param {String|Function} url or callback\n * @return {Request}\n * @api public\n */\n\nfunction request(method, url) {\n  // callback\n  if ('function' == typeof url) {\n    return new Request('GET', method).end(url);\n  }\n\n  // url first\n  if (1 == arguments.length) {\n    return new Request('GET', method);\n  }\n\n  return new Request(method, url);\n}\n\n/**\n * GET `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.get = function(url, data, fn){\n  var req = request('GET', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.query(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * HEAD `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.head = function(url, data, fn){\n  var req = request('HEAD', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * DELETE `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.del = function(url, fn){\n  var req = request('DELETE', url);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * PATCH `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.patch = function(url, data, fn){\n  var req = request('PATCH', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * POST `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.post = function(url, data, fn){\n  var req = request('POST', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * PUT `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.put = function(url, data, fn){\n  var req = request('PUT', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * Expose `request`.\n */\n\nmodule.exports = request;\n\n\n/***/ },\n/* 2 */\n/***/ function(module, exports, __webpack_require__) {\n\n\n/**\n * Expose `Emitter`.\n */\n\nmodule.exports = Emitter;\n\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n};\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks[event] = this._callbacks[event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  var self = this;\n  this._callbacks = this._callbacks || {};\n\n  function on() {\n    self.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks[event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks[event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n  var args = [].slice.call(arguments, 1)\n    , callbacks = this._callbacks[event];\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks[event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n\n\n/***/ },\n/* 3 */\n/***/ function(module, exports, __webpack_require__) {\n\n\n/**\n * Reduce `arr` with `fn`.\n *\n * @param {Array} arr\n * @param {Function} fn\n * @param {Mixed} initial\n *\n * TODO: combatible error handling?\n */\n\nmodule.exports = function(arr, fn, initial){  \n  var idx = 0;\n  var len = arr.length;\n  var curr = arguments.length == 3\n    ? initial\n    : arr[idx++];\n\n  while (idx < len) {\n    curr = fn.call(null, curr, arr[idx], ++idx, arr);\n  }\n  \n  return curr;\n};\n\n/***/ }\n/******/ ])\n\n\n/** WEBPACK FOOTER **\n ** clerk.min.js\n **/"," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 4803bd8433c155e21d67\n **/","\"use strict\";\n\n/*!\n\nclerk - CouchDB client for node and the browser.\nCopyright 2012-2015 Michael Phan-Ba\n\nLicensed under the Apache License, Version 2.0 (the \"License\");\nyou may not use this file except in compliance with the License.\nYou may obtain a copy of the License at\n\n    http://www.apache.org/licenses/LICENSE-2.0\n\nUnless required by applicable law or agreed to in writing, software\ndistributed under the License is distributed on an \"AS IS\" BASIS,\nWITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\nSee the License for the specific language governing permissions and\nlimitations under the License.\n\n*/\n\n/**\n * Module dependencies.\n */\n\nvar request = require(\"superagent\");\n\n/**\n * Copy properties from sources to target.\n *\n * @param {Object} target The target object.\n * @param {Object...} sources The source object.\n * @return {Object} The target object.\n * @api private\n */\n\nvar extend = function (target /* sources.. */) {\n  var source, key, i = 1;\n  while (source = arguments[i++]) {\n    for (key in source) target[key] = source[key];\n  }\n  return target;\n};\n\n/**\n * Stringify value.\n *\n * @param {Object} that That value to stringify.\n * @return {String} The stringifyed value.\n * @api private\n */\n\nvar asString = function (that) {\n  return Object.prototype.toString.call(that);\n};\n\n/**\n * Check if value is a string.\n *\n * @param {Object} that That value to check.\n * @return {Boolean} `true` if string, `false` otherwise.\n * @api private\n */\n\nvar isString = function (that) {\n  return asString(that) == \"[object String]\";\n};\n\n/**\n * Check if value is an object.\n *\n * @param {Object} that That value to check.\n * @return {Boolean} `true` if object, `false` otherwise.\n * @api private\n */\n\nvar isObject = function (that) {\n  return asString(that) == \"[object Object]\";\n};\n\n/**\n * Check if value is an array.\n *\n * @param {Object} that That value to check.\n * @return {Boolean} `true` if array, `false` otherwise.\n * @api private\n */\n\nvar isArray = function (that) {\n  return asString(that) == \"[object Array]\";\n};\n\n/**\n * Check if value is a function.\n *\n * @param {Object} that That value to check.\n * @return {Boolean} `true` if function, `false` otherwise.\n * @api private\n */\n\nvar isFunction = function (that) {\n  return asString(that) == \"[object Function]\";\n};\n\n/**\n * Clerk library entry point.\n *\n * @param {String} servers CouchDB server URI.\n * @return {Client|DB} If a URI path is given, returns a `DB`, otherwise\n *   returns a `Client`.\n * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/)\n * @see [CouchDB Guide](http://guide.couchdb.org/)\n * @see [Couchbase 2.0](http://www.couchbase.com/docs/couchbase-single-server-2.0/)\n */\n\nvar clerk = function (uri) {\n  return clerk.make(uri);\n};\n\n/**\n * Library version.\n */\n\nclerk.version = \"0.7.1\";\n\n/**\n * Default host.\n */\n\nclerk.defaultHost = \"http://127.0.0.1:5984\";\n\n/**\n * Promise implementation.\n */\n\nclerk.Promise = typeof Promise != \"undefined\" && Promise;\n\n/**\n * Create single CouchDB client.\n *\n * @param {String} uri Fully qualified URI.\n * @return {Client|DB} If `uri` has a path, the last segment of the\n *    path is used as the database name and a `DB` instance is\n *    returned. Otherwise, a `Client` instance is returned.\n */\n\nclerk.make = function (uri) {\n  if (!uri) return new clerk.Client(this.defaultHost);\n\n  uri = clerk._parseURI(uri);\n\n  var db = /\\/*([^\\/]+)\\/*$/.exec(uri.path);\n  if (db) {\n    uri.path = uri.path.substr(0, db.index);\n    db = db[1] && decodeURIComponent(db[1]);\n  }\n\n  // weird way of doing it, but it's more efficient...\n  if (uri.auth) uri.auth = 'Basic ' + clerk.btoa(uri.auth);\n\n  var client = new clerk.Client(uri.base + uri.path, uri.auth);\n  return db ? client.db(db) : client;\n};\n\n/**\n * Base64-encode a string.\n *\n * @param {String} str\n * @return {String}\n */\n\nclerk.btoa = typeof Buffer != \"undefined\" ? function (str) {\n  return new Buffer(str).toString(\"base64\");\n} : function (str) {\n  return btoa(str);\n};\n\n/**\n * Parse URI.\n *\n * The URI is normalized by removing extra `//` in the path.\n *\n * @param {String} uri Fully qualified URI.\n * @return {String} The normalized URI.\n */\n\nclerk._parseURI = function (uri) {\n  var match;\n\n  if (uri) {\n    if (match = /^(https?:\\/\\/)(?:([^\\/@]+)@)?([^\\/]+)(.*)\\/*$/.exec(uri)) {\n      return {\n        base: match[1] + match[3].replace(/\\/+/g, \"\\/\"),\n        path: match[4],\n        auth: match[2] && decodeURIComponent(match[2])\n      };\n    }\n  }\n\n  return { base: uri || \"\", path: \"\" };\n};\n\n/**\n * Base prototype for `Client` and `DB`.\n * Encapsulates HTTP methods, JSON handling, and response coersion.\n */\n\nclerk.Base = function () {};\n\nclerk.Base.prototype = {\n\n  /**\n   * Service request and parse JSON response.\n   *\n   * @param {String} [method=\"\"GET\"\"] HTTP method.\n   * @param {String} [path=this.uri] HTTP URI.\n   * @param {Object} [query] HTTP query options.\n   * @param {Object} [body] HTTP body.\n   * @param {Object} [headers] HTTP headers.\n   * @param {Function} [callback] Callback function.\n   *   @param {Error|null} error Error or `null` on success.\n   *   @param {Object} data Response data.\n   *   @param {Integer} status Response status code.\n   *   @param {Object} headers Response headers.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  request: function (/* [method], [path], [query], [data], [headers], [callback] */) {\n    var args = [].slice.call(arguments);\n    var callback = isFunction (args[args.length - 1]) && args.pop();\n\n    return this._request({\n      method: args[0],\n      path: args[1],\n      query: args[2],\n      data: args[3],\n      headers: args[4],\n      fn: callback\n    });\n  },\n\n  /**\n   * Internal service request and parse JSON response handler.\n   *\n   * @param {String} options\n   *   @param {String} method HTTP method.\n   *   @param {String} path HTTP URI.\n   *   @param {Object} query HTTP query options.\n   *   @param {Object} data HTTP body data.\n   *   @param {Object} headers HTTP headers.\n   *   @param {Function} fn Callback function.\n   *     @param {Error|null} error Error or `null` on success.\n   *     @param {Object} data Response data.\n   *     @param {Integer} status Response status code.\n   *     @param {Object} headers Response headers.\n   * @api private\n   */\n\n  _request: function (options) {\n    if (options.method == null) options.method = \"GET\";\n    if (options.headers == null) options.headers = {};\n    if (options.auth == null) options.auth = this.auth;\n\n    options.path = options.path ? \"/\" + options.path : \"\";\n\n    // set default headers\n    if (options.headers[\"Content-Type\"] == null) {\n      options.headers[\"Content-Type\"] = \"application/json\";\n    }\n    if (options.headers[\"Accept\"] == null) {\n      options.headers[\"Accept\"] = \"application/json\";\n    }\n    if (this.auth && options.headers[\"Authorization\"] == null) {\n      options.headers[\"Authorization\"] = this.auth;\n    }\n\n    options.uri = this.uri + options.path;\n    options.body = options.data && JSON.stringify(options.data,\n      /^\\/_design/.test(options.path) && this._replacer\n    ) || \"\";\n\n    // create promise if no callback given\n    var promise;\n    var fn = options.fn;\n    if (!fn && clerk.Promise) {\n      promise = clerk.Promise.defer();\n      fn = function (err, data, status, headers, res) {\n        if (err) {\n          err.body = data;\n          err.status = status;\n          err.headers = headers;\n          err.res = res;\n          promise.reject(err);\n        } else {\n          if (Object.defineProperties) {\n            Object.defineProperties(data, {\n              _status: { value: status },\n              _headers: { value: headers },\n              _response: { value: res },\n            });\n          }\n          promise.resolve(data);\n        };\n      };\n    }\n\n    // apply response transforms\n    var g = options._;\n    if (fn) {\n      options.fn = g ? function () {\n        fn.apply(this, g.apply(this, arguments) || arguments);\n      } : fn;\n    }\n\n    var req = this._do(options);\n\n    // return promise if it was created\n    if (promise) {\n      promise.promise.request = req;\n      return promise.promise;\n    }\n  },\n\n  /**\n   * Provider for servicing requests and parsing JSON responses.\n   *\n   * @param {String} options\n   *   @param {String} method HTTP method.\n   *   @param {String} uri HTTP URI.\n   *   @param {Object} query HTTP query options.\n   *   @param {Object} body HTTP body.\n   *   @param {Object} headers HTTP headers.\n   *   @param {Object} auth HTTP authentication.\n   *   @param {Function} fn Callback function.\n   *     @param {Error|null} error Error or `null` on success.\n   *     @param {Object} data Response data.\n   *     @param {Integer} status Response status code.\n   *     @param {Object} headers Response headers.\n   * @api private\n   */\n\n  _do: function (options) {\n    var self = this;\n    var key, value;\n\n    // create request\n    var req = request(options.method, options.uri);\n\n    // query string\n    if (options.query) {\n      // ensure query Array values are JSON encoded\n      for (key in options.query) {\n        if (typeof(value = options.query[key]) === \"object\") {\n          options.query[key] = JSON.stringify(value);\n        }\n      }\n      // set query on request\n      req.query(options.query);\n    }\n\n    // set headers\n    if (options.headers) {\n      req.set(options.headers);\n      // if authenticating\n      if (req.withCredentials && options.headers[\"Authorization\"] != null) {\n        req.withCredentials();\n      }\n    }\n\n    // send body\n    if (options.body) req.send(options.body);\n\n    // send request\n    var fn = options.fn;\n    req.end(function (res) {\n      var err = res.error;\n      var data;\n\n      if (!err) {\n        if (!(data = res.body || res.text)) {}\n        else if (data.error) err = self._error(data);\n        else data = self._response(data);\n      }\n\n      fn && fn(err || null, data, res.status, res.header, res);\n    });\n\n    return req;\n  },\n\n  /**\n   * Coerce response to normalize access to `_id` and `_rev`.\n   *\n   * @param {Object} json The response JSON.\n   * @return The coerced JSON.\n   * @api private\n   */\n\n  _response: function (json) {\n    var data = json.rows || json.results || json.uuids || isArray(json) && json;\n    var meta = this._meta;\n    var i = 0, len, item;\n\n    if (data) {\n      extend(data, json).json = json;\n      for (len = data.length; i < len; i++) {\n        item = data[i] = meta(data[i]);\n        if (item.doc) item.doc = meta(item.doc);\n      }\n    } else {\n      data = meta(json);\n    }\n\n    return data;\n  },\n\n  /**\n   * Make an error out of the response.\n   *\n   * @param {Object} json The response JSON.\n   * @return An `Error` object.\n   * @api private\n   */\n\n  _error: function (json) {\n    var err = new Error(json.reason);\n    err.code = json.error;\n    return extend(err, json);\n  },\n\n  /**\n   * JSON stringify functions. Used for encoding view documents to JSON.\n   *\n   * @param {String} key The key to stringify.\n   * @param {Object} val The value to stringify.\n   * @return {Object} The stringified function value or the value.\n   * @api private\n   */\n\n  _replacer: function (key, val) {\n    return isFunction (val) ? val.toString() : val;\n  },\n\n  /**\n   * Coerce documents with prototypical `_id` and `_rev`\n   * values.\n   *\n   * @param {Object} doc The document to coerce.\n   * @return {Object} The coerced document.\n   * @api private\n   */\n\n  _meta: function (doc) {\n    var hasId = !doc._id && doc.id;\n    var hasRev = !doc._rev && doc.rev;\n    var proto;\n\n    if (hasId || hasRev) {\n      proto = function (){};\n      doc = extend(new proto(), doc);\n      proto = proto.prototype;\n      if (hasId) proto._id = doc.id;\n      if (hasRev) proto._rev = doc.rev;\n    }\n\n    return doc;\n  },\n\n  /**\n   * HTTP headers to parse.\n   *\n   * @api private\n   */\n\n  _headers: [\n    \"cache-control\",\n    \"content-length\",\n    \"content-type\",\n    \"date\",\n    \"etag\",\n    \"server\"\n  ],\n\n  /**\n   * Parse arguments.\n   *\n   * @param {Array} args The arguments.\n   * @param {Integer} start The index from which to start reading arguments.\n   * @param {Boolean} withDoc Set to `true` if the doc source is given as a\n   *   parameter before HTTP query options.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @api private\n   */\n\n  _: function (args, start, withDoc) {\n    var self = this, doc, id, rev;\n\n    function request(method, path, options) {\n      if (!options) options = {};\n      return self._request({\n        method: method,\n        path: path || request.p,\n        query: options.q || request.q,\n        data: options.b || request.b,\n        headers: options.h || request.h,\n        fn: options.f || request.f,\n        _: options._ || request._\n      });\n    }\n\n    // [id], [doc], [query], [header], [callback]\n    args = [].slice.call(args, start || 0);\n\n    request.f = isFunction(args[args.length - 1]) && args.pop();\n    request.p = isString(args[0]) && encodeURI(args.shift());\n    request.q = args[withDoc ? 1 : 0] || {};\n    request.h = args[withDoc ? 2 : 1] || {};\n\n    if (withDoc) {\n      if (doc = (request.b = args[0])) {\n        if (id = request.p || doc._id || doc.id) request.p = id;\n        if (rev = request.q.rev || doc._rev || doc.rev) request.q.rev = rev;\n      }\n    }\n\n    return request;\n  }\n\n};\n\n/**\n * Clerk CouchDB client.\n *\n * @param {String} uri Fully qualified URI.\n * @param {String} [auth] Authentication header value.\n * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/Complete_HTTP_API_Reference)\n */\n\nclerk.Client = function (uri, auth) {\n  this.uri = uri;\n  this._db = {};\n  this.auth = auth;\n};\n\nclerk.Client.prototype = extend(new clerk.Base(), {\n\n  /**\n   * Select database to manipulate.\n   *\n   * @param {String} name DB name.\n   * @return {DB} DB object.\n   */\n\n  db: function (name) {\n    var db = this._db;\n    return db[name] || (db[name] = new clerk.DB(this, name, this.auth));\n  },\n\n  /**\n   * List all databases.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetAllDbs)\n   */\n\n  dbs: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\", \"_all_dbs\");\n  },\n\n  /**\n   * Get UUIDs.\n   *\n   * @param {Integer} [count=1] Number of UUIDs to get.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetUuids)\n   */\n\n  uuids: function (count /* [query], [headers], [callback] */) {\n    var request = this._(arguments, +count == count ? 1 : 0);\n    if (count > 1) request.q.count = count;\n    return request(\"GET\", \"_uuids\");\n  },\n\n  /**\n   * Get server information.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetRoot)\n   */\n\n  info: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\");\n  },\n\n  /**\n   * Get server stats.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetLog)\n   */\n\n  stats: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\", \"_stats\");\n  },\n\n  /**\n   * Get tail of the server log file.\n   *\n   * @param {Object} [query] Query parameters.\n   *   @param {Integer} [query.bytes=1000] Number of bytes to read.\n   *   @param {Integer} [query.offset=0] Number of bytes from the end of\n   *     log file to start reading.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetLog)\n   */\n\n  log: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\", \"_log\");\n  },\n\n  /**\n   * List running tasks.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HttpGetActiveTasks)\n   */\n\n  tasks: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\", \"_active_tasks\");\n  },\n\n  /**\n   * Get or set configuration values.\n   *\n   * @param {String} [key] Configuration section or key.\n   * @param {String} [value] Configuration value.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  config: function (/* [key], [value], [query], [headers], [callback] */) {\n    var args = [].slice.call(arguments);\n    var key = isString(args[0]) && args.shift() || \"\";\n    var value = isString(args[0]) && args.shift();\n    var method = isString(value) ? \"PUT\" : \"GET\";\n    return this._(args)(method, \"_config/\" + key, { b: value });\n  },\n\n  /**\n   * Replicate databases.\n   *\n   * @param {Object} options Options.\n   *   @param {String} options.source Source database URL or local name.\n   *   @param {String} options.target Target database URL or local name.\n   *   @param {Boolean} [options.cancel] Set to `true` to cancel replication.\n   *   @param {Boolean} [options.continuous] Set to `true` for continuous\n   *     replication.\n   *   @param {Boolean} [options.create_target] Set to `true` to create the\n   *     target database.\n   *   @param {String} [options.filter] Filter name for filtered replication.\n   *     Example: \"mydesign/myfilter\".\n   *   @param {Object} [options.query] Query parameters for filter.\n   *   @param {String[]} [options.doc_ids] Document IDs to replicate.\n   *   @param {String} [options.proxy] Proxy through which to replicate.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/Replication)\n   */\n\n  replicate: function (options /* [query], [headers], [callback] */) {\n    return this._(arguments, 1)(\"POST\", \"_replicate\", { b: options });\n  }\n\n});\n\n/**\n * Methods for CouchDB database.\n *\n * @param {Client} client Clerk client.\n * @param {String} name DB name.\n * @param {String} [auth] Authentication header value.\n * @return This object for chaining.\n */\n\nclerk.DB = function (client, name, auth) {\n  this.client = client;\n  this.name = name;\n  this.uri = client.uri + \"/\" + encodeURIComponent(name);\n  this.auth = auth;\n};\n\nclerk.DB.prototype = extend(new clerk.Base(), {\n\n  /**\n   * Create database.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  create: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"PUT\");\n  },\n\n  /**\n   * Destroy database.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  destroy: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"DELETE\");\n  },\n\n  /**\n   * Get database info.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  info: function (/* [query], [headers], callback */) {\n    return this._(arguments)(\"GET\");\n  },\n\n  /**\n   * Check if database exists.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  exists: function (/* [query], [headers], callback */) {\n    var request = this._(arguments);\n    request._ = function (err, body, status, headers, req) {\n      return [err, status === 200, status, headers, req];\n    };\n    return request(\"HEAD\");\n  },\n\n  /**\n   * Fetch document.\n   *\n   * Set `rev` in `query`.\n   *\n   * @param {String} id Document ID.\n   * @param {Object} [query] HTTP query options.\n   *   @param {Boolean} [query.revs] Fetch list of revisions.\n   *   @param {Boolean} [query.revs_info] Fetch detailed revision information.\n   * @param {Function} callback Callback function.\n   *   @param {Error|null} error Error or `null` on success.\n   *   @param {Object} data Response data.\n   *   @param {Integer} status Response status code.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#GET)\n   */\n\n  get: function (/* [id], [query], [headers], [callback] */) {\n    return this._(arguments)(\"GET\");\n  },\n\n  /**\n   * Get document metadata.\n   *\n   * @param {String} id Document ID.\n   * @param {Object} [query] HTTP query options.\n   * @param {Function} callback Callback function.\n   *   @param {Error|null} callback.error Error or `null` on success.\n   *   @param {Object|Object[]} [callback.body] Document metadata or array\n   *     of document metadata.\n   *     @param result.id Document ID.\n   *     @param result.rev Document revision.\n   *     @param [result.contentType] MIME content type. Only available when\n   *       getting metadata for single document.\n   *     @param [result.contentLength] Content length. Only available when\n   *       getting metadata for single document.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#HEAD)\n   */\n\n  head: function (/* [id], [query], [headers], callback */) {\n    var self = this;\n    var request = self._(arguments);\n    request._ = function (err, body, status, headers, res) {\n      return [err, err ? null : {\n        _id: request.p,\n        _rev: headers.etag && JSON.parse(headers.etag),\n        contentType: headers[\"content-type\"],\n        contentLength: headers[\"content-length\"]\n      }, status, headers, res];\n    };\n    return request(\"HEAD\");\n  },\n\n  /**\n   * Post document(s) to database.\n   *\n   * If documents have no ID, a document ID will be automatically generated\n   * on the server. If attachments are given, they will be automatically\n   * Base64 encoded. Streamed attachments are not supported. Attachments are\n   * only supported on Node.js.\n   *\n   * @param {Object} doc Document.\n   *   @param {String} [doc._id] Document ID. If set, uses given document ID.\n   *   @param {String} [doc._rev] Document revision. If set, allows update to\n   *     existing document.\n   *   @param {Object} [doc._attachments] Attachments. If given, must be a\n   *     map of filenames to attachment properties.\n   *     @param {String} [doc._attachments[filename]] Attachment filename, as\n   *       hash key.\n   *     @param {String} [doc._attachments[filename].contentType] Attachment\n   *       MIME content type.\n   *     @param {String|Object} [doc._attachments[filename].data] Attachment\n   *       data. Will be Base64 encoded.\n   * @param {Object} [query] HTTP query options.\n   *   @param {Boolean} [query.batch] Allow server to write document in\n   *     batch mode. Documents will not be written to disk immediately,\n   *     increasing the chances of write failure.\n   *   @param {Boolean} [query.all_or_nothing] For batch updating of\n   *     documents, use all-or-nothing semantics.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#POST)\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Bulk_Document_API)\n   */\n\n  post: function (docs /* [query], [headers], [callback] */) {\n    var request = this._(arguments, 1);\n    if (isArray(docs)) {\n      request.p = \"_bulk_docs\";\n      request.b = extend({ docs: docs }, request.q);\n      request.q = null\n    } else {\n      request.b = docs;\n    }\n    return request(\"POST\");\n  },\n\n  /**\n   * Put document in database.\n   *\n   * @param {Object} doc Document data. Requires `id` and `rev`.\n   * @param {String} [options] Options.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#PUT)\n   */\n\n  put: function (/* [id], [doc], [query], [headers], [callback] */) {\n    var request = this._(arguments, 0, 1);\n    // prevent acidentally creating database\n    if (!request.p) request.p = request.b._id || request.b.id;\n    if (!request.p) throw new Error(\"missing id\");\n    return request(\"PUT\");\n  },\n\n  /**\n   * Delete document(s).\n   *\n   * @param {String} doc Document or document ID.\n   * @param {Object} [query] HTTP query options.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#DELETE)\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Bulk_Document_API)\n   */\n\n  del: function (docs /* [query], [headers], [callback] */) {\n    if (isArray(docs)) {\n      var i = 0, len = docs.length, doc;\n      for (; i < len; i++) {\n        doc = docs[i], docs[i] = {\n          _id: doc._id || doc.id,\n          _rev: doc._rev || doc.rev,\n          _deleted: true\n        };\n      }\n      return this.post.apply(this, arguments);\n    } else {\n      var request = this._(arguments, 0, 1);\n      // prevent acidentally deleting database\n      if (!request.p) throw new Error(\"missing id\");\n      return request(\"DELETE\");\n    }\n  },\n\n  /**\n   * Copy document.\n   *\n   * @param {Object} source Source document.\n   *   @param {String} source.id Source document ID.\n   *   @param {String} [source.rev] Source document revision.\n   *   @param {String} [source._id] Source document ID. Alternate key for\n   *     `source.id`.\n   *   @param {String} [source._rev] Source document revision. Alternate key\n   *     for `source.id`.\n   * @param {Object} target Target document.\n   *   @param {String} target.id Target document ID.\n   *   @param {String} [target.rev] Target document revision.\n   *   @param {String} [target._id] Target document ID. Alternate key for\n   *     `target.id`.\n   *   @param {String} [target._rev] Target document revision. Alternate key\n   *     for `target.id`.\n   * @param {Object} [query] HTTP query options.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Document_API#COPY)\n   */\n\n  copy: function (source, target /* [query], [headers], [callback] */) {\n    var request = this._(arguments, 2);\n    var sourcePath = encodeURIComponent(source.id || source._id || source);\n    var targetPath = encodeURIComponent(target.id || target._id || target);\n    var sourceRev = source.rev || source._rev;\n    var targetRev = target.rev || target._rev;\n\n    if (sourceRev) request.q.rev = sourceRev;\n    if (targetRev) targetPath += \"?rev=\" + encodeURIComponent(targetRev);\n\n    request.h.Destination = targetPath;\n\n    return request(\"COPY\", sourcePath);\n  },\n\n  /**\n   * Query all documents by ID.\n   *\n   * @param {Object} [query] HTTP query options.\n   *   @param {JSON} [query.startkey] Start returning results from this\n   *     document ID.\n   *   @param {JSON} [query.endkey] Stop returning results at this document\n   *     ID.\n   *   @param {Integer} [query.limit] Limit number of results returned.\n   *   @param {Boolean} [query.descending=false] Lookup results in reverse\n   *     order by key, returning documents in descending order by key.\n   *   @param {Integer} [query.skip] Skip this many records before\n   *     returning results.\n   *   @param {Boolean} [query.include_docs=false] Include document source for\n   *     each result.\n   *   @param {Boolean} [query.include_end=true] Include `query.endkey`\n   *     in results.\n   *   @param {Boolean} [query.update_seq=false] Include sequence value\n   *     of the database corresponding to the view.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_Bulk_Document_API)\n   */\n\n  all: function (/* [query], [headers], [callback] */) {\n    var request = this._(arguments);\n    var body = this._viewOptions(request.q);\n    return request(body ? \"POST\" : \"GET\", \"_all_docs\", { b: body });\n  },\n\n  /**\n   * Query a view.\n   *\n   * @param {String|Object} view View name (e.g. mydesign/myview) or\n   *   temporary view definition. Using a temporary view is strongly not\n   *   recommended for production use.\n   * @param {Object} [query] HTTP query options.\n   *   @param {JSON} [query.key] Key to lookup.\n   *   @param {JSON} [query.startkey] Start returning results from this key.\n   *   @param {String} [query.startkey_docid] Start returning results\n   *     from this document ID. Allows pagination with duplicate keys.\n   *   @param {JSON} [query.endkey] Stop returning results at this key.\n   *   @param {String} [query.endkey_docid] Stop returning results at\n   *     this document ID. Allows pagination with duplicate keys.\n   *   @param {Integer} [query.limit] Limit number of results returned.\n   *   @param {Boolean|String} [query.stale] Do not refresh view even if\n   *     stale. For CouchDB versions `1.1.0` and up, set to `update_after` to\n   *     update view after results are returned.\n   *   @param {Boolean} [query.descending=false] Lookup results in reverse\n   *     order by key, returning documents in descending order by key.\n   *   @param {Integer} [query.skip] Skip this many records before\n   *     returning results.\n   *   @param {Boolean|Integer} [query.group=false] Use the reduce function\n   *     to group results by key. Set to an integer specify `group_level`.\n   *   @param {Boolean|Integer} [query.reduce=true] Use the reduce function.\n   *   @param {Boolean} [query.fetch=false] Include document source for\n   *     each result.\n   *   @param {Boolean} [query.include_end=true] Include `query.endkey`\n   *     in results.\n   *   @param {Boolean} [query.update_seq=false] Include sequence value\n   *     of the database corresponding to the view.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_view_API)\n   */\n\n  find: function (view /* [query], [headers], [callback] */) {\n    var request = this._(arguments, 1), path, body;\n\n    if (isString(view)) {\n      path = view.split(\"/\", 2);\n      path = \"_design/\" + encodeURIComponent(path[0]) +\n             \"/_view/\" + encodeURIComponent(path[1]);\n    } else {\n      path = \"_temp_view\";\n      body = view;\n    }\n\n    body = this._viewOptions(request.q, body);\n    return request(body ? \"POST\" : \"GET\", path, { b: body });\n  },\n\n  /**\n   * Get database changes.\n   *\n   * The `feed` option determines how the callback is called:\n   *\n   *   - `normal` calls the callback once.\n   *   - `longpoll` waits for a response, then calls the callback once.\n   *   - `continuous` calls the callback each time an update is received.\n   *     Implemented as the `database#follow()` method.\n   *\n   * @param {Object} [query] HTTP query options.\n   *   @param {String} [query.feed=\"normal\"] Type of feed. See comments\n   *     above.\n   *   @param {String} [query.filter] Filter updates using this filter.\n   *   @param {Integer} [query.limit] Maximum number of rows to return.\n   *   @param {Integer} [query.since=0] Start results from this sequence\n   *     number.\n   *   @param {Boolean} [query.include_docs=false] Include documents with\n   *     results.\n   *   @param {Integer} [query.timeout=1000] Maximum period in milliseconds\n   *     to wait for a change before sending a response, even if there are no\n   *     results.\n   *   @param {Integer} [query.heartbeat=1000] Period in milliseconds after\n   *     which an empty line is sent. Applicable only to feed types\n   *     `longpoll` and `continuous`. Overrides `query.timeout` to keep the\n   *     feed alive indefinitely.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/HTTP_database_API#Changes)\n   */\n\n  changes: function (/* [query], [headers], [callback] */) {\n    var request = this._(arguments);\n    if (request.q.feed != \"longpoll\") delete request.q.feed;\n    return this._changes(request);\n  },\n\n  /**\n   * Get database changes.\n   *\n   * @see `#changes()`.\n   */\n\n  follow: function (/* [query], [headers], callback */) {\n    var request = this._(arguments);\n    var fn = request.f;\n\n    if (!fn) return this;\n\n    request.q.feed = \"longpoll\";\n    request.f = function (err, body) {\n      var args = [].slice.call(arguments);\n      var done, i;\n      for (i = 0; i < body.length; i++) {\n        args[1] = body[i];\n        if (done = fn.apply(this, args) === false || err) break;\n      }\n      if (!done) this._changes(request);\n    };\n\n    return this._changes(request);\n  },\n\n  /**\n   * Service a changes request.\n   *\n   * @api private\n   */\n\n  _changes: function (request) {\n    return request(\"GET\", \"_changes\");\n  },\n\n  /**\n   * Update document using server-side handler.\n   *\n   * @param {String} handler Update handler. Example: mydesign/myhandler\n   * @param {String} [id] Document ID.\n   * @param {Object} [query] HTTP query options.\n   * @param {Object|String} [data] Data.\n   * @param {Object} [headers] Headers.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/Document_Update_Handlers)\n   */\n\n  update: function (handler /* [id], [query], [data], [headers], [callback] */) {\n    var request = this._(arguments, 1, 1);\n    var path = handler.split(\"/\", 2);\n\n    path = \"_design/\" + encodeURIComponent(path[0]) +\n           \"/_update/\" + encodeURIComponent(path[1]);\n\n    if (request.p) path += \"/\" + request.p;\n\n    return request(request.p ? \"PUT\" : \"POST\", path, {\n      q: request.b,\n      b: request.q\n    });\n  },\n\n  /**\n   * Download attachment from document.\n   *\n   * @param {Object|String} docOrId Document or document ID.\n   * @param {String} attachmentName Attachment name.\n   * @param {Object} [query] HTTP query options.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  attachment: function (doc, attachmentName /* [query], [headers], [callback] */) {\n    var request = this._(arguments, 2);\n    var path = encodeURIComponent(doc._id || doc.id || doc) + \"/\" +\n               encodeURIComponent(attachmentName);\n    return request(\"GET\", path, options);\n  },\n\n  /**\n   * Upload attachment to document.\n   *\n   * Set the `Content-Type` header.\n   *\n   * @param {Object} [doc] Document. Requires `id`. `rev` can be specified\n   *   here or in `query`.\n   * @param {String} attachmentName Attachment name.\n   * @param {Object} data Data.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  attach: function (doc, attachmentName, data /* [query], [headers], [callback] */) {\n    var request = this._(arguments, 3);\n    request.p = encodeURIComponent(doc._id || doc.id) + \"/\" +\n                encodeURIComponent(attachmentName);\n    if (!request.q.rev) request.q.rev = doc._rev || doc.rev;\n    request.q.body = data;\n    return request(\"PUT\", path);\n  },\n\n  /**\n   * Replicate database.\n   *\n   * This convenience function sets `options.source` and `options.target` to\n   * the selected database name. Either `options.source` or `options.target`\n   * must be overridden for a successful replication request.\n   *\n   * @param {Options} options Options. Accepts all options from\n   *   `Client.replicate()`.\n   *   @param {String} [options.source=this.name] Source database URL or\n   *     local name. Defaults to the selected database name if not given.\n   *   @param {String} [options.target=this.name] Target database URL or\n   *     local name. Defaults to the selected database name if not given.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  replicate: function (options /* [query], [headers], [callback] */) {\n    if (!options.source) options.source = this.name;\n    if (!options.target) options.target = this.name;\n    return this.client.replicate.apply(this.client, arguments);\n  },\n\n  /**\n   * Ensure recent changes are committed to disk.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  commit: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"POST\", \"_ensure_full_commit\");\n  },\n\n  /**\n   * Purge deleted documents from database.\n   *\n   * @param {Object} revs Map of document IDs to revisions to be purged.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   */\n\n  purge: function (revs /* [query], [headers], [callback] */) {\n    return this._(arguments, 1)(\"POST\", \"_purge\", { b: revs });\n  },\n\n  /**\n   * Compact database or design.\n   *\n   * @param {String} [design] Design name if compacting design indexes.\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/Compaction)\n   */\n\n  compact: function (/* [design], [query], [headers], [callback] */) {\n    var request = this._(arguments);\n    return request(\"POST\", \"_compact/\" + (request.p || \"\"));\n  },\n\n  /**\n   * Remove unused views.\n   *\n   * @return {Promise} If no callback is provided, a Promise is returned.\n   * @see [CouchDB Wiki](http://wiki.apache.org/couchdb/Compaction)\n   */\n\n  vacuum: function (/* [query], [headers], [callback] */) {\n    return this._(arguments)(\"POST\", \"_view_cleanup\");\n  },\n\n  /**\n   * Parse view options.\n   *\n   * @param {Object} query The HTTP query options.\n   * @param {Object} body The body payload.\n   * @return {Object} The body payload.\n   * @api private\n   */\n\n  _viewOptions: function (q, body) {\n    if (q) {\n      if (q.key) q.key = JSON.stringify(q.key);\n      if (q.startkey) q.startkey = JSON.stringify(q.startkey);\n      if (q.endkey) q.endkey = JSON.stringify(q.endkey);\n      if (q.stale && q.stale != \"update_after\") q.stale = \"ok\";\n      if (q.keys) {\n        if (!body) body = {};\n        body.keys = q.keys;\n        delete q.keys;\n      }\n    }\n    return body;\n  }\n\n});\n\n/**\n * Export clerk.\n */\n\nmodule.exports = clerk;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./clerk.js\n ** module id = 0\n ** module chunks = 0\n **/","/**\n * Module dependencies.\n */\n\nvar Emitter = require('emitter');\nvar reduce = require('reduce');\n\n/**\n * Root reference for iframes.\n */\n\nvar root = 'undefined' == typeof window\n  ? this\n  : window;\n\n/**\n * Noop.\n */\n\nfunction noop(){};\n\n/**\n * Check if `obj` is a host object,\n * we don't want to serialize these :)\n *\n * TODO: future proof, move to compoent land\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isHost(obj) {\n  var str = {}.toString.call(obj);\n\n  switch (str) {\n    case '[object File]':\n    case '[object Blob]':\n    case '[object FormData]':\n      return true;\n    default:\n      return false;\n  }\n}\n\n/**\n * Determine XHR.\n */\n\nfunction getXHR() {\n  if (root.XMLHttpRequest\n    && ('file:' != root.location.protocol || !root.ActiveXObject)) {\n    return new XMLHttpRequest;\n  } else {\n    try { return new ActiveXObject('Microsoft.XMLHTTP'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.6.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP.3.0'); } catch(e) {}\n    try { return new ActiveXObject('Msxml2.XMLHTTP'); } catch(e) {}\n  }\n  return false;\n}\n\n/**\n * Removes leading and trailing whitespace, added to support IE.\n *\n * @param {String} s\n * @return {String}\n * @api private\n */\n\nvar trim = ''.trim\n  ? function(s) { return s.trim(); }\n  : function(s) { return s.replace(/(^\\s*|\\s*$)/g, ''); };\n\n/**\n * Check if `obj` is an object.\n *\n * @param {Object} obj\n * @return {Boolean}\n * @api private\n */\n\nfunction isObject(obj) {\n  return obj === Object(obj);\n}\n\n/**\n * Serialize the given `obj`.\n *\n * @param {Object} obj\n * @return {String}\n * @api private\n */\n\nfunction serialize(obj) {\n  if (!isObject(obj)) return obj;\n  var pairs = [];\n  for (var key in obj) {\n    if (null != obj[key]) {\n      pairs.push(encodeURIComponent(key)\n        + '=' + encodeURIComponent(obj[key]));\n    }\n  }\n  return pairs.join('&');\n}\n\n/**\n * Expose serialization method.\n */\n\n request.serializeObject = serialize;\n\n /**\n  * Parse the given x-www-form-urlencoded `str`.\n  *\n  * @param {String} str\n  * @return {Object}\n  * @api private\n  */\n\nfunction parseString(str) {\n  var obj = {};\n  var pairs = str.split('&');\n  var parts;\n  var pair;\n\n  for (var i = 0, len = pairs.length; i < len; ++i) {\n    pair = pairs[i];\n    parts = pair.split('=');\n    obj[decodeURIComponent(parts[0])] = decodeURIComponent(parts[1]);\n  }\n\n  return obj;\n}\n\n/**\n * Expose parser.\n */\n\nrequest.parseString = parseString;\n\n/**\n * Default MIME type map.\n *\n *     superagent.types.xml = 'application/xml';\n *\n */\n\nrequest.types = {\n  html: 'text/html',\n  json: 'application/json',\n  xml: 'application/xml',\n  urlencoded: 'application/x-www-form-urlencoded',\n  'form': 'application/x-www-form-urlencoded',\n  'form-data': 'application/x-www-form-urlencoded'\n};\n\n/**\n * Default serialization map.\n *\n *     superagent.serialize['application/xml'] = function(obj){\n *       return 'generated xml here';\n *     };\n *\n */\n\n request.serialize = {\n   'application/x-www-form-urlencoded': serialize,\n   'application/json': JSON.stringify\n };\n\n /**\n  * Default parsers.\n  *\n  *     superagent.parse['application/xml'] = function(str){\n  *       return { object parsed from str };\n  *     };\n  *\n  */\n\nrequest.parse = {\n  'application/x-www-form-urlencoded': parseString,\n  'application/json': JSON.parse\n};\n\n/**\n * Parse the given header `str` into\n * an object containing the mapped fields.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction parseHeader(str) {\n  var lines = str.split(/\\r?\\n/);\n  var fields = {};\n  var index;\n  var line;\n  var field;\n  var val;\n\n  lines.pop(); // trailing CRLF\n\n  for (var i = 0, len = lines.length; i < len; ++i) {\n    line = lines[i];\n    index = line.indexOf(':');\n    field = line.slice(0, index).toLowerCase();\n    val = trim(line.slice(index + 1));\n    fields[field] = val;\n  }\n\n  return fields;\n}\n\n/**\n * Return the mime type for the given `str`.\n *\n * @param {String} str\n * @return {String}\n * @api private\n */\n\nfunction type(str){\n  return str.split(/ *; */).shift();\n};\n\n/**\n * Return header field parameters.\n *\n * @param {String} str\n * @return {Object}\n * @api private\n */\n\nfunction params(str){\n  return reduce(str.split(/ *; */), function(obj, str){\n    var parts = str.split(/ *= */)\n      , key = parts.shift()\n      , val = parts.shift();\n\n    if (key && val) obj[key] = val;\n    return obj;\n  }, {});\n};\n\n/**\n * Initialize a new `Response` with the given `xhr`.\n *\n *  - set flags (.ok, .error, etc)\n *  - parse header\n *\n * Examples:\n *\n *  Aliasing `superagent` as `request` is nice:\n *\n *      request = superagent;\n *\n *  We can use the promise-like API, or pass callbacks:\n *\n *      request.get('/').end(function(res){});\n *      request.get('/', function(res){});\n *\n *  Sending data can be chained:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' })\n *        .end(function(res){});\n *\n *  Or passed to `.send()`:\n *\n *      request\n *        .post('/user')\n *        .send({ name: 'tj' }, function(res){});\n *\n *  Or passed to `.post()`:\n *\n *      request\n *        .post('/user', { name: 'tj' })\n *        .end(function(res){});\n *\n * Or further reduced to a single call for simple cases:\n *\n *      request\n *        .post('/user', { name: 'tj' }, function(res){});\n *\n * @param {XMLHTTPRequest} xhr\n * @param {Object} options\n * @api private\n */\n\nfunction Response(req, options) {\n  options = options || {};\n  this.req = req;\n  this.xhr = this.req.xhr;\n  this.text = this.req.method !='HEAD' \n     ? this.xhr.responseText \n     : null;\n  this.setStatusProperties(this.xhr.status);\n  this.header = this.headers = parseHeader(this.xhr.getAllResponseHeaders());\n  // getAllResponseHeaders sometimes falsely returns \"\" for CORS requests, but\n  // getResponseHeader still works. so we get content-type even if getting\n  // other headers fails.\n  this.header['content-type'] = this.xhr.getResponseHeader('content-type');\n  this.setHeaderProperties(this.header);\n  this.body = this.req.method != 'HEAD'\n    ? this.parseBody(this.text)\n    : null;\n}\n\n/**\n * Get case-insensitive `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api public\n */\n\nResponse.prototype.get = function(field){\n  return this.header[field.toLowerCase()];\n};\n\n/**\n * Set header related properties:\n *\n *   - `.type` the content type without params\n *\n * A response of \"Content-Type: text/plain; charset=utf-8\"\n * will provide you with a `.type` of \"text/plain\".\n *\n * @param {Object} header\n * @api private\n */\n\nResponse.prototype.setHeaderProperties = function(header){\n  // content-type\n  var ct = this.header['content-type'] || '';\n  this.type = type(ct);\n\n  // params\n  var obj = params(ct);\n  for (var key in obj) this[key] = obj[key];\n};\n\n/**\n * Parse the given body `str`.\n *\n * Used for auto-parsing of bodies. Parsers\n * are defined on the `superagent.parse` object.\n *\n * @param {String} str\n * @return {Mixed}\n * @api private\n */\n\nResponse.prototype.parseBody = function(str){\n  var parse = request.parse[this.type];\n  return parse && str && str.length\n    ? parse(str)\n    : null;\n};\n\n/**\n * Set flags such as `.ok` based on `status`.\n *\n * For example a 2xx response will give you a `.ok` of __true__\n * whereas 5xx will be __false__ and `.error` will be __true__. The\n * `.clientError` and `.serverError` are also available to be more\n * specific, and `.statusType` is the class of error ranging from 1..5\n * sometimes useful for mapping respond colors etc.\n *\n * \"sugar\" properties are also defined for common cases. Currently providing:\n *\n *   - .noContent\n *   - .badRequest\n *   - .unauthorized\n *   - .notAcceptable\n *   - .notFound\n *\n * @param {Number} status\n * @api private\n */\n\nResponse.prototype.setStatusProperties = function(status){\n  var type = status / 100 | 0;\n\n  // status / class\n  this.status = status;\n  this.statusType = type;\n\n  // basics\n  this.info = 1 == type;\n  this.ok = 2 == type;\n  this.clientError = 4 == type;\n  this.serverError = 5 == type;\n  this.error = (4 == type || 5 == type)\n    ? this.toError()\n    : false;\n\n  // sugar\n  this.accepted = 202 == status;\n  this.noContent = 204 == status || 1223 == status;\n  this.badRequest = 400 == status;\n  this.unauthorized = 401 == status;\n  this.notAcceptable = 406 == status;\n  this.notFound = 404 == status;\n  this.forbidden = 403 == status;\n};\n\n/**\n * Return an `Error` representative of this response.\n *\n * @return {Error}\n * @api public\n */\n\nResponse.prototype.toError = function(){\n  var req = this.req;\n  var method = req.method;\n  var url = req.url;\n\n  var msg = 'cannot ' + method + ' ' + url + ' (' + this.status + ')';\n  var err = new Error(msg);\n  err.status = this.status;\n  err.method = method;\n  err.url = url;\n\n  return err;\n};\n\n/**\n * Expose `Response`.\n */\n\nrequest.Response = Response;\n\n/**\n * Initialize a new `Request` with the given `method` and `url`.\n *\n * @param {String} method\n * @param {String} url\n * @api public\n */\n\nfunction Request(method, url) {\n  var self = this;\n  Emitter.call(this);\n  this._query = this._query || [];\n  this.method = method;\n  this.url = url;\n  this.header = {};\n  this._header = {};\n  this.on('end', function(){\n    var err = null;\n    var res = null;\n\n    try {\n      res = new Response(self); \n    } catch(e) {\n      err = new Error('Parser is unable to parse the response');\n      err.parse = true;\n      err.original = e;\n    }\n\n    self.callback(err, res);\n  });\n}\n\n/**\n * Mixin `Emitter`.\n */\n\nEmitter(Request.prototype);\n\n/**\n * Allow for extension\n */\n\nRequest.prototype.use = function(fn) {\n  fn(this);\n  return this;\n}\n\n/**\n * Set timeout to `ms`.\n *\n * @param {Number} ms\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.timeout = function(ms){\n  this._timeout = ms;\n  return this;\n};\n\n/**\n * Clear previous timeout.\n *\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.clearTimeout = function(){\n  this._timeout = 0;\n  clearTimeout(this._timer);\n  return this;\n};\n\n/**\n * Abort the request, and clear potential timeout.\n *\n * @return {Request}\n * @api public\n */\n\nRequest.prototype.abort = function(){\n  if (this.aborted) return;\n  this.aborted = true;\n  this.xhr.abort();\n  this.clearTimeout();\n  this.emit('abort');\n  return this;\n};\n\n/**\n * Set header `field` to `val`, or multiple fields with one object.\n *\n * Examples:\n *\n *      req.get('/')\n *        .set('Accept', 'application/json')\n *        .set('X-API-Key', 'foobar')\n *        .end(callback);\n *\n *      req.get('/')\n *        .set({ Accept: 'application/json', 'X-API-Key': 'foobar' })\n *        .end(callback);\n *\n * @param {String|Object} field\n * @param {String} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.set = function(field, val){\n  if (isObject(field)) {\n    for (var key in field) {\n      this.set(key, field[key]);\n    }\n    return this;\n  }\n  this._header[field.toLowerCase()] = val;\n  this.header[field] = val;\n  return this;\n};\n\n/**\n * Remove header `field`.\n *\n * Example:\n *\n *      req.get('/')\n *        .unset('User-Agent')\n *        .end(callback);\n *\n * @param {String} field\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.unset = function(field){\n  delete this._header[field.toLowerCase()];\n  delete this.header[field];\n  return this;\n};\n\n/**\n * Get case-insensitive header `field` value.\n *\n * @param {String} field\n * @return {String}\n * @api private\n */\n\nRequest.prototype.getHeader = function(field){\n  return this._header[field.toLowerCase()];\n};\n\n/**\n * Set Content-Type to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.xml = 'application/xml';\n *\n *      request.post('/')\n *        .type('xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n *      request.post('/')\n *        .type('application/xml')\n *        .send(xmlstring)\n *        .end(callback);\n *\n * @param {String} type\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.type = function(type){\n  this.set('Content-Type', request.types[type] || type);\n  return this;\n};\n\n/**\n * Set Accept to `type`, mapping values from `request.types`.\n *\n * Examples:\n *\n *      superagent.types.json = 'application/json';\n *\n *      request.get('/agent')\n *        .accept('json')\n *        .end(callback);\n *\n *      request.get('/agent')\n *        .accept('application/json')\n *        .end(callback);\n *\n * @param {String} accept\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.accept = function(type){\n  this.set('Accept', request.types[type] || type);\n  return this;\n};\n\n/**\n * Set Authorization field value with `user` and `pass`.\n *\n * @param {String} user\n * @param {String} pass\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.auth = function(user, pass){\n  var str = btoa(user + ':' + pass);\n  this.set('Authorization', 'Basic ' + str);\n  return this;\n};\n\n/**\n* Add query-string `val`.\n*\n* Examples:\n*\n*   request.get('/shoes')\n*     .query('size=10')\n*     .query({ color: 'blue' })\n*\n* @param {Object|String} val\n* @return {Request} for chaining\n* @api public\n*/\n\nRequest.prototype.query = function(val){\n  if ('string' != typeof val) val = serialize(val);\n  if (val) this._query.push(val);\n  return this;\n};\n\n/**\n * Write the field `name` and `val` for \"multipart/form-data\"\n * request bodies.\n *\n * ``` js\n * request.post('/upload')\n *   .field('foo', 'bar')\n *   .end(callback);\n * ```\n *\n * @param {String} name\n * @param {String|Blob|File} val\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.field = function(name, val){\n  if (!this._formData) this._formData = new FormData();\n  this._formData.append(name, val);\n  return this;\n};\n\n/**\n * Queue the given `file` as an attachment to the specified `field`,\n * with optional `filename`.\n *\n * ``` js\n * request.post('/upload')\n *   .attach(new Blob(['<a id=\"a\"><b id=\"b\">hey!</b></a>'], { type: \"text/html\"}))\n *   .end(callback);\n * ```\n *\n * @param {String} field\n * @param {Blob|File} file\n * @param {String} filename\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.attach = function(field, file, filename){\n  if (!this._formData) this._formData = new FormData();\n  this._formData.append(field, file, filename);\n  return this;\n};\n\n/**\n * Send `data`, defaulting the `.type()` to \"json\" when\n * an object is given.\n *\n * Examples:\n *\n *       // querystring\n *       request.get('/search')\n *         .end(callback)\n *\n *       // multiple data \"writes\"\n *       request.get('/search')\n *         .send({ search: 'query' })\n *         .send({ range: '1..5' })\n *         .send({ order: 'desc' })\n *         .end(callback)\n *\n *       // manual json\n *       request.post('/user')\n *         .type('json')\n *         .send('{\"name\":\"tj\"})\n *         .end(callback)\n *\n *       // auto json\n *       request.post('/user')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // manual x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send('name=tj')\n *         .end(callback)\n *\n *       // auto x-www-form-urlencoded\n *       request.post('/user')\n *         .type('form')\n *         .send({ name: 'tj' })\n *         .end(callback)\n *\n *       // defaults to x-www-form-urlencoded\n  *      request.post('/user')\n  *        .send('name=tobi')\n  *        .send('species=ferret')\n  *        .end(callback)\n *\n * @param {String|Object} data\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.send = function(data){\n  var obj = isObject(data);\n  var type = this.getHeader('Content-Type');\n\n  // merge\n  if (obj && isObject(this._data)) {\n    for (var key in data) {\n      this._data[key] = data[key];\n    }\n  } else if ('string' == typeof data) {\n    if (!type) this.type('form');\n    type = this.getHeader('Content-Type');\n    if ('application/x-www-form-urlencoded' == type) {\n      this._data = this._data\n        ? this._data + '&' + data\n        : data;\n    } else {\n      this._data = (this._data || '') + data;\n    }\n  } else {\n    this._data = data;\n  }\n\n  if (!obj) return this;\n  if (!type) this.type('json');\n  return this;\n};\n\n/**\n * Invoke the callback with `err` and `res`\n * and handle arity check.\n *\n * @param {Error} err\n * @param {Response} res\n * @api private\n */\n\nRequest.prototype.callback = function(err, res){\n  var fn = this._callback;\n  this.clearTimeout();\n  if (2 == fn.length) return fn(err, res);\n  if (err) return this.emit('error', err);\n  fn(res);\n};\n\n/**\n * Invoke callback with x-domain error.\n *\n * @api private\n */\n\nRequest.prototype.crossDomainError = function(){\n  var err = new Error('Origin is not allowed by Access-Control-Allow-Origin');\n  err.crossDomain = true;\n  this.callback(err);\n};\n\n/**\n * Invoke callback with timeout error.\n *\n * @api private\n */\n\nRequest.prototype.timeoutError = function(){\n  var timeout = this._timeout;\n  var err = new Error('timeout of ' + timeout + 'ms exceeded');\n  err.timeout = timeout;\n  this.callback(err);\n};\n\n/**\n * Enable transmission of cookies with x-domain requests.\n *\n * Note that for this to work the origin must not be\n * using \"Access-Control-Allow-Origin\" with a wildcard,\n * and also must set \"Access-Control-Allow-Credentials\"\n * to \"true\".\n *\n * @api public\n */\n\nRequest.prototype.withCredentials = function(){\n  this._withCredentials = true;\n  return this;\n};\n\n/**\n * Initiate request, invoking callback `fn(res)`\n * with an instanceof `Response`.\n *\n * @param {Function} fn\n * @return {Request} for chaining\n * @api public\n */\n\nRequest.prototype.end = function(fn){\n  var self = this;\n  var xhr = this.xhr = getXHR();\n  var query = this._query.join('&');\n  var timeout = this._timeout;\n  var data = this._formData || this._data;\n\n  // store callback\n  this._callback = fn || noop;\n\n  // state change\n  xhr.onreadystatechange = function(){\n    if (4 != xhr.readyState) return;\n    if (0 == xhr.status) {\n      if (self.aborted) return self.timeoutError();\n      return self.crossDomainError();\n    }\n    self.emit('end');\n  };\n\n  // progress\n  if (xhr.upload) {\n    xhr.upload.onprogress = function(e){\n      e.percent = e.loaded / e.total * 100;\n      self.emit('progress', e);\n    };\n  }\n\n  // timeout\n  if (timeout && !this._timer) {\n    this._timer = setTimeout(function(){\n      self.abort();\n    }, timeout);\n  }\n\n  // querystring\n  if (query) {\n    query = request.serializeObject(query);\n    this.url += ~this.url.indexOf('?')\n      ? '&' + query\n      : '?' + query;\n  }\n\n  // initiate request\n  xhr.open(this.method, this.url, true);\n\n  // CORS\n  if (this._withCredentials) xhr.withCredentials = true;\n\n  // body\n  if ('GET' != this.method && 'HEAD' != this.method && 'string' != typeof data && !isHost(data)) {\n    // serialize stuff\n    var serialize = request.serialize[this.getHeader('Content-Type')];\n    if (serialize) data = serialize(data);\n  }\n\n  // set header fields\n  for (var field in this.header) {\n    if (null == this.header[field]) continue;\n    xhr.setRequestHeader(field, this.header[field]);\n  }\n\n  // send stuff\n  this.emit('request', this);\n  xhr.send(data);\n  return this;\n};\n\n/**\n * Expose `Request`.\n */\n\nrequest.Request = Request;\n\n/**\n * Issue a request:\n *\n * Examples:\n *\n *    request('GET', '/users').end(callback)\n *    request('/users').end(callback)\n *    request('/users', callback)\n *\n * @param {String} method\n * @param {String|Function} url or callback\n * @return {Request}\n * @api public\n */\n\nfunction request(method, url) {\n  // callback\n  if ('function' == typeof url) {\n    return new Request('GET', method).end(url);\n  }\n\n  // url first\n  if (1 == arguments.length) {\n    return new Request('GET', method);\n  }\n\n  return new Request(method, url);\n}\n\n/**\n * GET `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.get = function(url, data, fn){\n  var req = request('GET', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.query(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * HEAD `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.head = function(url, data, fn){\n  var req = request('HEAD', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * DELETE `url` with optional callback `fn(res)`.\n *\n * @param {String} url\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.del = function(url, fn){\n  var req = request('DELETE', url);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * PATCH `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.patch = function(url, data, fn){\n  var req = request('PATCH', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * POST `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed} data\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.post = function(url, data, fn){\n  var req = request('POST', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * PUT `url` with optional `data` and callback `fn(res)`.\n *\n * @param {String} url\n * @param {Mixed|Function} data or fn\n * @param {Function} fn\n * @return {Request}\n * @api public\n */\n\nrequest.put = function(url, data, fn){\n  var req = request('PUT', url);\n  if ('function' == typeof data) fn = data, data = null;\n  if (data) req.send(data);\n  if (fn) req.end(fn);\n  return req;\n};\n\n/**\n * Expose `request`.\n */\n\nmodule.exports = request;\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/superagent/lib/client.js\n ** module id = 1\n ** module chunks = 0\n **/","\n/**\n * Expose `Emitter`.\n */\n\nmodule.exports = Emitter;\n\n/**\n * Initialize a new `Emitter`.\n *\n * @api public\n */\n\nfunction Emitter(obj) {\n  if (obj) return mixin(obj);\n};\n\n/**\n * Mixin the emitter properties.\n *\n * @param {Object} obj\n * @return {Object}\n * @api private\n */\n\nfunction mixin(obj) {\n  for (var key in Emitter.prototype) {\n    obj[key] = Emitter.prototype[key];\n  }\n  return obj;\n}\n\n/**\n * Listen on the given `event` with `fn`.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.on =\nEmitter.prototype.addEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n  (this._callbacks[event] = this._callbacks[event] || [])\n    .push(fn);\n  return this;\n};\n\n/**\n * Adds an `event` listener that will be invoked a single\n * time then automatically removed.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.once = function(event, fn){\n  var self = this;\n  this._callbacks = this._callbacks || {};\n\n  function on() {\n    self.off(event, on);\n    fn.apply(this, arguments);\n  }\n\n  on.fn = fn;\n  this.on(event, on);\n  return this;\n};\n\n/**\n * Remove the given callback for `event` or all\n * registered callbacks.\n *\n * @param {String} event\n * @param {Function} fn\n * @return {Emitter}\n * @api public\n */\n\nEmitter.prototype.off =\nEmitter.prototype.removeListener =\nEmitter.prototype.removeAllListeners =\nEmitter.prototype.removeEventListener = function(event, fn){\n  this._callbacks = this._callbacks || {};\n\n  // all\n  if (0 == arguments.length) {\n    this._callbacks = {};\n    return this;\n  }\n\n  // specific event\n  var callbacks = this._callbacks[event];\n  if (!callbacks) return this;\n\n  // remove all handlers\n  if (1 == arguments.length) {\n    delete this._callbacks[event];\n    return this;\n  }\n\n  // remove specific handler\n  var cb;\n  for (var i = 0; i < callbacks.length; i++) {\n    cb = callbacks[i];\n    if (cb === fn || cb.fn === fn) {\n      callbacks.splice(i, 1);\n      break;\n    }\n  }\n  return this;\n};\n\n/**\n * Emit `event` with the given args.\n *\n * @param {String} event\n * @param {Mixed} ...\n * @return {Emitter}\n */\n\nEmitter.prototype.emit = function(event){\n  this._callbacks = this._callbacks || {};\n  var args = [].slice.call(arguments, 1)\n    , callbacks = this._callbacks[event];\n\n  if (callbacks) {\n    callbacks = callbacks.slice(0);\n    for (var i = 0, len = callbacks.length; i < len; ++i) {\n      callbacks[i].apply(this, args);\n    }\n  }\n\n  return this;\n};\n\n/**\n * Return array of callbacks for `event`.\n *\n * @param {String} event\n * @return {Array}\n * @api public\n */\n\nEmitter.prototype.listeners = function(event){\n  this._callbacks = this._callbacks || {};\n  return this._callbacks[event] || [];\n};\n\n/**\n * Check if this emitter has `event` handlers.\n *\n * @param {String} event\n * @return {Boolean}\n * @api public\n */\n\nEmitter.prototype.hasListeners = function(event){\n  return !! this.listeners(event).length;\n};\n\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/superagent/~/component-emitter/index.js\n ** module id = 2\n ** module chunks = 0\n **/","\n/**\n * Reduce `arr` with `fn`.\n *\n * @param {Array} arr\n * @param {Function} fn\n * @param {Mixed} initial\n *\n * TODO: combatible error handling?\n */\n\nmodule.exports = function(arr, fn, initial){  \n  var idx = 0;\n  var len = arr.length;\n  var curr = arguments.length == 3\n    ? initial\n    : arr[idx++];\n\n  while (idx < len) {\n    curr = fn.call(null, curr, arr[idx], ++idx, arr);\n  }\n  \n  return curr;\n};\n\n\n/*****************\n ** WEBPACK FOOTER\n ** ./~/superagent/~/reduce-component/index.js\n ** module id = 3\n ** module chunks = 0\n **/"],"sourceRoot":""}